/*!
 * ============================================================================
 *   ID SW PLATFORM TEAM, LG ELECTRONICS INC., SEOUL, KOREA                       
 *   Copyright(c) 2016 by LG Electronics Inc.                                  
 *                                                                             
 *   Release Version : 1.4.3.0
 * ============================================================================
 */
cordova.define("cordova/plugin/sound",function(c,e,b){function d(k){}var f;if(window.PalmSystem){d("Window.PalmSystem Available");f=c("cordova/plugin/webos/service")}else{f={Request:function(k,l){d(k+" invoked. But I am a dummy because PalmSystem is not available");if(typeof l.onFailure==="function"){l.onFailure({returnValue:false,errorText:"PalmSystem Not Available. Cordova is not installed?"})}}}}var h=function(){};function i(l,m,k){if(l.errorCode===undefined||l.errorCode===null){l.errorCode=m}if(l.errorText===undefined||l.errorText===null){l.errorText=k}}var g=null;var a={};function j(k){if(g===null){f.Request("luna://com.webos.service.tv.systemproperty",{method:"getSystemInfo",parameters:{keys:["sdkVersion","boardType"]},onSuccess:function(l){d("getPlatformInfo: onSuccess");d("version : "+l.sdkVersion);var m=l.sdkVersion.split(".");if(m.length>=1&&m[0]==="1"){a={webOSVer:1,chipset:l.boardType.split("_")[0]}}else{if(m.length>=1&&m[0]==="2"){a={webOSVer:2,chipset:l.boardType.split("_")[0]}}else{if(m.length>=1&&m[0]==="3"){a={webOSVer:3,chipset:l.boardType.split("_")[0]}}else{a={webOSVer:0,chipset:""}}}}g=a.webOSVer;k(a)},onFailure:function(l){d("getPlatformInfo: onFailure");a={webOSVer:0,chipset:""};k(a)}})}else{k(a)}}h.SoundMode={Standard:"standard",Cinema:"movie",ClearVoice:"news",Sports:"sports",Music:"music",Game:"game"};h.SpeakerType={SignageSpeaker:"tv_speaker",LGSoundSync:"bt_soundbar"};h.prototype.getSoundStatus=function(k,l){d("getSoundStatus: ");f.Request("luna://com.webos.service.config/",{method:"getConfigs",parameters:{configNames:["tv.model.supportCommerSoundSetting"]},onSuccess:function(m){d("getConfigs: On Success");if(m.returnValue===true){var n=m.configs["tv.model.supportCommerSoundSetting"];if(n===true){f.Request("luna://com.webos.audio/",{method:"getVolume",onSuccess:function(o){d("getSoundStatus: On Success");if(o.returnValue===true){var p={};p.level=o.volume;p.muted=o.muted;f.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"get",parameters:{category:"commercial",keys:["enableSpeaker"]},onSuccess:function(q){d("getSoundStatus: On Success 2");if(q.returnValue===true){p.externalSpeaker=(q.settings.enableSpeaker==="on"?true:false);if(typeof k==="function"){k(p)}}},onFailure:function(q){d("getSoundStatus: On Failure 2");delete q.returnValue;if(typeof l==="function"){i(q,"SGSS","Sound.getSoundStatus returns failure.");l(q)}}})}},onFailure:function(o){d("getSoundStatus: On Failure");delete o.returnValue;if(typeof l==="function"){i(o,"SGSS","Sound.getSoundStatus returns failure.");l(o)}}})}else{delete m.returnValue;if(typeof l==="function"){i(m,"SGSS","unsupported feature");l(m)}return}d("Sound.getSoundStatus Done")}},onFailure:function(m){d("getConfigs: On Failure");delete m.returnValue;if(typeof l==="function"){i(m,"SGSS","Sound.getSoundStatus returns failure.");l(m)}}});d("Sound.getSoundStatus Done")};h.prototype.setVolumeLevel=function(l,m,n){d("setVolumeLevel: "+JSON.stringify(n));if(typeof n.level!=="number"||isNaN(n.level)||n.level<0||n.level>100){if(typeof m==="function"){var k={};i(k,"SSVL","Sound.setVolumeLevel returns failure. out of range or invalid parameter type.");m(k)}return}f.Request("luna://com.webos.service.config/",{method:"getConfigs",parameters:{configNames:["tv.model.supportCommerSoundSetting"]},onSuccess:function(o){d("getConfigs: On Success");if(o.returnValue===true){var p=o.configs["tv.model.supportCommerSoundSetting"];if(p===true){if(n.volOsdEnabled===false){f.Request("luna://com.webos.service.config/",{method:"setConfigs",parameters:{configs:{"com.webos.surfacemanager.volumeOSD":false}},onSuccess:function(q){if(q.returnValue===true){f.Request("luna://com.webos.audio/",{method:"setVolume",parameters:{volume:n.level},onSuccess:function(r){d("setVolumeLevel: On Success");if(r.returnValue===true){setTimeout(function(){f.Request("luna://com.webos.service.config/",{method:"setConfigs",parameters:{configs:{"com.webos.surfacemanager.volumeOSD":true}},onSuccess:function(s){if(s.returnValue===true){if(typeof l==="function"){l()}}},onFailure:function(s){delete s.returnValue;if(typeof m==="function"){i(s,"SSVL","Sound.setVolumeLevel returns failure.");m(s);return}}})},2000)}},onFailure:function(r){d("setVolumeLevel: On Failure");delete r.returnValue;if(typeof m==="function"){i(r,"SSVL","Sound.setVolumeLevel returns failure.");m(r)}}})}},onFailure:function(q){delete q.returnValue;if(typeof m==="function"){i(q,"SSVL","Sound.setVolumeLevel returns failure.");m(q);return}}})}else{f.Request("luna://com.webos.audio/",{method:"setVolume",parameters:{volume:n.level},onSuccess:function(q){d("setVolumeLevel: On Success");if(q.returnValue===true){if(typeof l==="function"){l()}}},onFailure:function(q){d("setVolumeLevel: On Failure");delete q.returnValue;if(typeof m==="function"){i(q,"SSVL","Sound.setVolumeLevel returns failure.");m(q)}}})}}else{delete o.returnValue;if(typeof m==="function"){i(o,"SSVL","unsupported feature");m(o)}return}}},onFailure:function(o){d("getConfigs: On Failure");delete o.returnValue;if(typeof m==="function"){i(o,"SSVL","Sound.setVolumeLevel returns failure");m(o)}}});d("Sound.setVolumeLevel Done")};h.prototype.setExternalSpeaker=function(l,m,o){d("setExternalSpeaker: "+JSON.stringify(o));if(typeof o.externalSpeaker!=="boolean"){if(typeof m==="function"){var k={};i(k,"SSVL","Sound.setExternalSpeaker returns failure. out of range or invalid parameter type.");m(k)}return}var n=null;switch(o.externalSpeaker){case true:n="on";break;case false:n="off";break}f.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"commercial",settings:{enableSpeaker:n}},onSuccess:function(){d("setExternalSpeaker: On Success");if(typeof l==="function"){l()}},onFailure:function(p){d("setExternalSpeaker: On Failure");delete p.returnValue;if(typeof m==="function"){i(p,"SSES","Sound.setExternalSpeaker returns failure.");m(p)}}});d("Sound.setExternalSpeaker Done")};h.prototype.setMuted=function(l,m,n){d("setMuted: "+JSON.stringify(n));if(typeof n.muted!=="boolean"){if(typeof m==="function"){var k={};i(k,"SSVL","Sound.setMuted returns failure. out of range or invalid parameter type.");m(k)}return}f.Request("luna://com.webos.service.config/",{method:"getConfigs",parameters:{configNames:["tv.model.supportCommerSoundSetting"]},onSuccess:function(o){d("getConfigs: On Success");if(o.returnValue===true){var p=o.configs["tv.model.supportCommerSoundSetting"];if(p===true){f.Request("luna://com.webos.audio/",{method:"setMuted",parameters:{muted:n.muted},onSuccess:function(q){d("setMuted: On Success");if(q.returnValue===true){if(typeof l==="function"){l()}}},onFailure:function(q){d("setMuted: On Failure");delete q.returnValue;if(typeof m==="function"){i(q,"SSM","Sound.setMuted returns failure.");m(q)}}})}else{delete o.returnValue;if(typeof m==="function"){i(o,"SSM","unsupported feature");m(o)}return}}},onFailure:function(o){d("getConfigs: On Failure");delete o.returnValue;if(typeof m==="function"){i(o,"SSM","Sound.setMuted returns failure");m(o)}}});d("Sound.setMuted Done")};h.prototype.setSoundMode=function(l,m,n){var o=null;switch(n.mode){case h.SoundMode.Standard:o="standard";break;case h.SoundMode.Cinema:o="movie";break;case h.SoundMode.ClearVoice:o="news";break;case h.SoundMode.Sports:o="sports";break;case h.SoundMode.Music:o="music";break;case h.SoundMode.Game:o="game";break}if(((n.balance<-50)||(n.balance>50))&&isNumber(n.balance)){var k={};i(k,"SSSM","Sound.setSoundMode returns failure. Out of range.");m(k);d("Sound.setSoundMode invalid range")}d("setSoundMode: "+o);if(o===null&&typeof m==="function"){var k={};i(k,"SSSM","Sound.setSoundMode returns failure. command was not defined.");m(k);d("Sound.setSoundMode invalid ");return}f.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"sound",settings:{soundMode:o,audioBalance:n.balance}},onSuccess:function(p){d("setSoundMode: On Success");if(p.returnValue===true){if(typeof l==="function"){l()}}},onFailure:function(p){d("setSoundMode: On Failure");delete p.returnValue;if(typeof m==="function"){i(p,"SSSM","Sound.setSoundMode returns failure.");m(p)}}});d("Sound.setSoundMode Done")};h.prototype.getSoundMode=function(k,l){d("getSoundMode: ");f.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"get",parameters:{category:"sound",keys:["soundMode","audioBalance"]},onSuccess:function(m){d("getSoundMode: On Success");if(m.returnValue===true){var n={};n.mode=m.settings.soundMode;n.balance=m.settings.audioBalance;if(typeof k==="function"){k(n)}}},onFailure:function(m){d("getSoundMode: On Failure");delete m.returnValue;if(typeof l==="function"){i(m,"SGSM","Sound.getSoundMode returns failure.");l(m)}}});d("Sound.getSoundMode Done")};h.prototype.setSoundOut=function(k,l,m){j(function(o){if(o.webOSVer!==3){var n={};i(n,"SSSO","Sound.setSoundOut returns failure. Only webOS 3.0 support setSoundOut API.");l(n);d("not support setSoundOut");return}f.Request("luna://com.webos.service.config/",{method:"getConfigs",parameters:{configNames:["system.supportBluetoothFeatures"]},onSuccess:function(p){d("getConfigs: On Success");if(p.returnValue===true){var r=p.configs["system.supportBluetoothFeatures"];if(r.indexOf("btsound")===-1){if(m.speakerType===h.SpeakerType.LGSoundSync){var p={};i(p,"SSSO","Sound.setSoundOut returns failure. bluetooth soundsync is not supported.");l(p);return}}var q=null;switch(m.speakerType){case h.SpeakerType.SignageSpeaker:q="tv_speaker";break;case h.SpeakerType.LGSoundSync:q="bt_soundbar";break}d("setSoundOut: "+q);if(q===null&&typeof l==="function"){var p={};i(p,"SSSO","Sound.setSoundOut returns failure. command was not defined.");l(p);d("Sound.setSoundOut invalid ");return}f.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"sound",settings:{soundOutput:q}},onSuccess:function(s){d("setSoundOut: On Success");if(s.returnValue===true){if(typeof k==="function"){k()}}},onFailure:function(s){d("setSoundOut: On Failure");delete s.returnValue;if(typeof l==="function"){i(s,"SSSO","Sound.setSoundOut returns failure.");l(s)}}});d("Sound.setSoundOut Done")}},onFailure:function(p){d("getConfigs: On Failure");delete p.returnValue;if(typeof l==="function"){i(p,"SSSO","unsupported feature");l(p)}}})})};h.prototype.getSoundOut=function(k,l){j(function(n){if(n.webOSVer!==3){var m={};i(m,"SGSO","Sound.getSoundOut returns failure. Only webOS 3.0 support getSoundOut API.");l(m);d("not support getSoundOut");return}d("getSoundOut: ");f.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"get",parameters:{category:"sound",keys:["soundOutput"]},onSuccess:function(o){d("getSoundOut: On Success");if(o.returnValue===true){var p={};p.speakerType=o.settings.soundOutput;if(typeof k==="function"){k(p)}}},onFailure:function(o){d("getSoundOut: On Failure");delete o.returnValue;if(typeof l==="function"){i(o,"SGSO","Sound.getSoundOut returns failure.");l(o)}}});d("Sound.getSoundOut Done")})};b.exports=h});Sound=cordova.require("cordova/plugin/sound");