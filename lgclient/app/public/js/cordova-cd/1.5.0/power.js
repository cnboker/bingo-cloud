Power=(function(){var b,a;function h(i){}if(typeof window==="object"){cordova.define("cordova/plugin/power",function(j,i,k){b=function(){};if(window.PalmSystem){h("Window.PalmSystem Available");a=j("cordova/plugin/webos/service")}else{a={Request:function(l,m){h(l+" invoked. But I am a dummy because PalmSystem is not available");if(typeof m.onFailure==="function"){m.onFailure({returnValue:false,errorText:"PalmSystem Not Available. Cordova is not installed?"})}}}}k.exports=b});b=cordova.require("cordova/plugin/power")}else{b=function(i){a=i;a.Request=function(j,l){var k=j+"/"+l.method;var m={};if(l.hasOwnProperty("parameters")===true){m=l.parameters}var n={};var o=function(p){console.log("res : "+JSON.stringify(p));if(p.payload.returnValue===true){n=p.payload;l.onSuccess(n)}else{n.returnValue=false;n.errorCode=p.payload.errorCode;n.errorText=p.payload.errorText;l.onFailure(n)}};if(a){a.call(k,m,o)}}};module.exports=b}function e(j,k,i){if(j.errorCode===undefined||j.errorCode===null){j.errorCode=k}if(j.errorText===undefined||j.errorText===null){j.errorText=i}}var d=null;var g={};function f(i){if(d===null){a.Request("luna://com.webos.service.tv.systemproperty",{method:"getSystemInfo",parameters:{keys:["sdkVersion","boardType"]},onSuccess:function(j){h("getPlatformInfo: onSuccess");h("version : "+j.sdkVersion);var k=j.sdkVersion.split(".");if(k.length>=1&&k[0]==="1"){g={webOSVer:1,chipset:j.boardType.split("_")[0]}}else{if(k.length>=1&&k[0]==="2"){g={webOSVer:2,chipset:j.boardType.split("_")[0]}}else{if(k.length>=1&&k[0]==="3"){g={webOSVer:3,chipset:j.boardType.split("_")[0]}}else{g={webOSVer:0,chipset:""}}}}d=g.webOSVer;delete j.returnValue;i(g)},onFailure:function(j){h("getPlatformInfo: onFailure");delete j.returnValue;g={webOSVer:0,chipset:""};i(g)}})}else{i(g)}}function c(i){if(g.chipset=="H15"){switch(i){case"ext://hdmi:1":return"HDMI1";case"ext://hdmi:2":return"HDMI2";case"ext://hdmi:3":return"OPS/HDMI3/DVI";case"ext://dvi:1":return"OPS/HDMI3/DVI";case"ext://dp:1":return"DISPLAYPORT";case"ext://rgb:1":return"RGB";case"ext://ops:1":return"OPS/HDMI3/DVI";case"HDMI1":return"ext://hdmi:1";case"HDMI2":return"ext://hdmi:2";case"HDMI3":return"ext://hdmi:3";case"DVI":return"ext://dvi:1";case"DISPLAYPORT":return"ext://dp:1";case"RGB":return"ext://rgb:1";case"OPS":return"ext://ops:1";case"OPS/HDMI3/DVI":return"ext://hdmi:3"}}else{switch(i){case"ext://hdmi:1":return"HDMI1";case"ext://hdmi:2":return"HDMI2";case"ext://hdmi:3":return"HDMI3";case"ext://dvi:1":return"DVI";case"ext://dp:1":return"DISPLAYPORT";case"ext://rgb:1":return"RGB";case"ext://ops:1":return"OPS";case"HDMI1":return"ext://hdmi:1";case"HDMI":return"ext://hdmi:1";case"HDMI2":return"ext://hdmi:2";case"HDMI3":return"ext://hdmi:3";case"DVI":return"ext://dvi:1";case"DISPLAYPORT":return"ext://dp:1";case"RGB":return"ext://rgb:1";case"OPS":return"ext://ops:1";case"OPS/HDMI3/DVI":return"ext://hdmi:3"}}return null}b.PowerCommand={SHUTDOWN:"powerOff",REBOOT:"reboot"};b.DisplayMode={DISPLAY_OFF:"Screen Off",DISPLAY_ON:"Active"};b.TimerWeek={MONDAY:1,TUESDAY:2,WEDNESDAY:4,THURSDAY:8,FRIDAY:16,SATURDAY:32,SUNDAY:64,EVERYDAY:127};b.DPMSignalType={CLOCK:"clock",CLOCK_WITH_DATA:"clockAndData"};b.PMMode={PowerOff:"powerOff",SustainAspectRatio:"sustainAspectRatio",ScreenOff:"screenOff",ScreenOffAlways:"screenOffAlways",ScreenOffBacklight:"screenOffBacklight"};b.prototype.getPowerStatus=function(i,j){h("getPowerStatus: ");a.Request("luna://com.webos.service.tv.signage/",{method:"getPowerState",onSuccess:function(k){h("getPowerStatus: On Success");var l={};if(k.returnValue===true){l.displayMode=k.state}a.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"get",parameters:{category:"commercial",keys:["wolEnable"]},onSuccess:function(m){h("getPowerStatus: On Success 2");if(m.returnValue===true){l.wakeOnLan=(m.settings.wolEnable==="1"?true:false)}a.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"get",parameters:{category:"time",keys:["onTimerEnable","offTimerEnable"]},onSuccess:function(n){h("getPowerStatus: On Success 3");if(n.returnValue===true){l.allOnTimer=(n.settings.onTimerEnable==="on"?true:false);l.allOffTimer=(n.settings.offTimerEnable==="on"?true:false);if(typeof i==="function"){i(l)}}},onFailure:function(n){h("getPowerStatus: On Failure 3");delete n.returnValue;if(typeof j==="function"){e(n,"PGPS","Power.getPowerStatus returns failure.");j(n)}}})},onFailure:function(m){h("getPowerStatus: On Failure 2");delete m.returnValue;if(typeof j==="function"){e(m,"PGPS","Power.getPowerStatus returns failure.");j(m)}}})},onFailure:function(k){h("getPowerStatus: On Failure");delete k.returnValue;if(typeof j==="function"){e(k,"PGPS","Power.getPowerStatus returns failure.");j(k)}}});h("Power.getPowerStatus Done")};b.prototype.enableAllOnTimer=function(j,k,l){h("enableAllOnTimer: "+JSON.stringify(l));var m=null;switch(l.allOnTimer){case true:m="on";break;case false:m="off";break;default:if(typeof k==="function"){var i={};e(i,"PEAOT","Power.enableAllOnTimer returns failure. Invalid option value.");k(i)}return}a.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"time",settings:{onTimerEnable:m}},onSuccess:function(){if(l.clearOnTimer===true){var q=0;var n=["0","0","0","0","0","0","0"],p=["0","0","0","0","0","0","0"],o=["0","0","0","0","0","0","0"],r=["0","0","0","0","0","0","0"],s=[];a.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"commercial",settings:{multiOnTimerHour:n,multiOnTimerMinute:p,multiOnTimerWeekday:o,multiOnTimerSource:r,onTimerCount:q,onTimerSchedule:s}},onSuccess:function(){h("enableAllOnTimer: On Success 2");if(typeof j==="function"){j()}},onFailure:function(t){h("enableAllOnTimer: On Failure 2");delete t.returnValue;if(typeof k==="function"){e(t,"PEAOT","Power.enableAllOnTimer returns failure. / clearOnTimer");k(t)}}})}else{if(typeof j==="function"){h("enableAllOnTimer: On Success");j()}}},onFailure:function(n){delete n.returnValue;if(typeof k==="function"){h("enableAllOnTimer: On Failure");e(n,"PEAOT","Power.enableAllOnTimer returns failure.");k(n)}}});h("Power.enableAllOnTimer Done")};b.prototype.enableAllOffTimer=function(j,k,l){h("enableAllOffTimer: "+JSON.stringify(l));var m=null;switch(l.allOffTimer){case true:m="on";break;case false:m="off";break;default:if(typeof k==="function"){var i={};e(i,"PEAOT","Power.enableAllOffTimer returns failure. Invalid option value.");k(i)}return}a.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"time",settings:{offTimerEnable:m}},onSuccess:function(){if(l.clearOffTimer===true){var q=0;var n=["0","0","0","0","0","0","0"],p=["0","0","0","0","0","0","0"],o=["0","0","0","0","0","0","0"],r=[];a.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"commercial",settings:{multiOffTimerHour:n,multiOffTimerMinute:p,multiOffTimerWeekday:o,offTimerCount:q,offTimerSchedule:r}},onSuccess:function(){h("enableAllOffTimer: On Success 2");if(typeof j==="function"){j()}},onFailure:function(s){h("enableAllOffTimer: On Failure 2");delete s.returnValue;if(typeof k==="function"){e(s,"PEAOT","Power.enableAllOffTimer returns failure. / clearOffTimer");k(s)}}})}else{if(typeof j==="function"){h("enableAllOffTimer: On Success");j()}}},onFailure:function(n){delete n.returnValue;if(typeof k==="function"){h("enableAllOffTimer: On Failure");e(n,"PEAOT","Power.enableAllOffTimer returns failure.");k(n)}}});h("Power.enableAllOffTimer Done")};b.prototype.enableWakeOnLan=function(j,k,l){h("enableWakeOnLan: "+JSON.stringify(l));var m=null;switch(l.wakeOnLan){case true:m="1";break;case false:m="0";break;default:if(typeof k==="function"){var i={};e(i,"PSWOL","Power.enableWakeOnLan returns failure. Invalid option value.");k(i)}return}a.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"commercial",settings:{wolEnable:m}},onSuccess:function(){if(typeof j==="function"){h("enableWakeOnLan: On Success");j()}},onFailure:function(n){delete n.returnValue;if(typeof k==="function"){h("enableWakeOnLan: On Failure");e(n,"PSWOL","Power.enableWakeOnLan returns failure.");k(n)}}});h("Power.enableWakeOnLan Done")};b.prototype.addOnTimer=function(j,k,l){h("addOnTimer: "+JSON.stringify(l));if(l.hour===undefined||isNaN(l.hour)||typeof l.hour!=="number"||l.hour<0||l.hour>23||l.minute===undefined||isNaN(l.minute)||typeof l.minute!=="number"||l.minute<0||l.minute>59||l.week===undefined||isNaN(l.week)||typeof l.week!=="number"||l.week<0||l.week>127||l.inputSource===undefined||typeof l.inputSource!=="string"||l.inputSource.indexOf("ext://")!==0){if(typeof k==="function"){var i={};e(i,"PAOT","Power.addOnTimer returns failure. invalid parameters or out of range.");k(i)}return}f(function(m){a.Request("luna://com.webos.service.eim/",{method:"getAllInputStatus",onSuccess:function(n){h("getInputSourceStatus: On Success");if(n.returnValue===true){var s=false;for(var r=0;r<n.totalCount;r++){var q=n.devices[r].deviceName.toLowerCase();var t=q;var o=l.inputSource.substring(6).split(":");var p="1";if(isNaN(q.substring(q.length-1,q.length))===false){q=q.substring(0,q.length-1);p=n.devices[r].id.split("_")[1]}if(q.toUpperCase()==="DISPLAYPORT"){q="DP"}if(q.toUpperCase().indexOf(o[0].toUpperCase())>=0&&p===o[1]){s=true;break}}if(s===false){h("addOnTimer: On Failure");delete n.returnValue;if(typeof k==="function"){e(n,"PAOT","Power.addOnTimer returns failure.");k(n)}return}a.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"get",parameters:{category:"commercial",keys:["multiOnTimerHour","multiOnTimerMinute","multiOnTimerWeekday","multiOnTimerSource","onTimerSchedule","onTimerCount"]},onSuccess:function(u){if(u.returnValue===true){h("version : "+m.webOSVer);if(typeof u.settings.multiOnTimerHour==="string"){u.settings.multiOnTimerHour=JSON.parse(u.settings.multiOnTimerHour)}if(typeof u.settings.multiOnTimerMinute==="string"){u.settings.multiOnTimerMinute=JSON.parse(u.settings.multiOnTimerMinute)}if(typeof u.settings.multiOnTimerWeekday==="string"){u.settings.multiOnTimerWeekday=JSON.parse(u.settings.multiOnTimerWeekday)}if(typeof u.settings.multiOnTimerSource==="string"){u.settings.multiOnTimerSource=JSON.parse(u.settings.multiOnTimerSource)}if(typeof u.settings.onTimerSchedule==="string"){u.settings.onTimerSchedule=JSON.parse(u.settings.onTimerSchedule)}var w=(u.settings.onTimerSchedule===null||u.settings.onTimerSchedule===undefined?0:u.settings.onTimerSchedule.length);if(u.settings.multiOnTimerHour.length<=w){if(typeof k==="function"){e(u,"PSOT","Power.addOnTimer returns failure. No space to add timer.");k(u)}return}if(m.webOSVer===3){if(l.week>=64){l.week=1+(l.week-64)*2}else{l.week=l.week*2}}u.settings.multiOnTimerHour[w]=l.hour;u.settings.multiOnTimerMinute[w]=l.minute;u.settings.multiOnTimerWeekday[w]=l.week;u.settings.multiOnTimerSource[w]=t.toUpperCase();var v=360;u.settings.onTimerSchedule[w]={_id:""+v++,hour:l.hour,input:t.toUpperCase(),minute:l.minute,weekday:l.week};a.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"commercial",settings:{multiOnTimerHour:u.settings.multiOnTimerHour,multiOnTimerMinute:u.settings.multiOnTimerMinute,multiOnTimerWeekday:u.settings.multiOnTimerWeekday,multiOnTimerSource:u.settings.multiOnTimerSource,onTimerCount:w+1,onTimerSchedule:u.settings.onTimerSchedule}},onSuccess:function(){h("addOnTimer: On Success 2");if(typeof j==="function"){j()}},onFailure:function(x){h("addOnTimer: On Failure 2");delete x.returnValue;if(typeof k==="function"){e(x,"PAOT","Power.addOnTimer returns failure.");k(x)}return}})}},onFailure:function(u){h("addOnTimer: On Failure");delete u.returnValue;if(typeof k==="function"){e(u,"PAOT","Power.addOnTimer returns failure.");k(u)}return}})}},onFailure:function(n){h("getInputSourceStatus: On Failure");delete n.returnValue;if(typeof k==="function"){e(n,"PAOT","Power.addOnTimer returns failure on gathering input list.");k(n)}return}})});h("Power.addOnTimer Done")};b.prototype.deleteOnTimer=function(j,k,l){h("deleteOnTimer: "+JSON.stringify(l));if(l.hour===undefined||isNaN(l.hour)||typeof l.hour!=="number"||l.hour<0||l.hour>23||l.minute===undefined||isNaN(l.minute)||typeof l.minute!=="number"||l.minute<0||l.minute>59||l.week===undefined||isNaN(l.week)||typeof l.week!=="number"||l.week<0||l.week>127||l.inputSource===undefined||typeof l.inputSource!=="string"||l.inputSource.indexOf("ext://")!==0){if(typeof k==="function"){var i={};e(i,"PDOT","Power.deleteOnTimer returns failure. invalid parameters or out of range.");k(i)}return}a.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"get",parameters:{category:"commercial",keys:["multiOnTimerHour","multiOnTimerMinute","multiOnTimerWeekday","multiOnTimerSource","onTimerSchedule","onTimerCount"]},onSuccess:function(m){if(m.returnValue===true){f(function(n){a.Request("luna://com.webos.service.eim/",{method:"getAllInputStatus",onSuccess:function(r){h("getInputSourceStatus: On Success");if(m.returnValue===true){h("version : "+n.webOSVer);if(typeof m.settings.multiOnTimerHour==="string"){m.settings.multiOnTimerHour=JSON.parse(m.settings.multiOnTimerHour)}if(typeof m.settings.multiOnTimerMinute==="string"){m.settings.multiOnTimerMinute=JSON.parse(m.settings.multiOnTimerMinute)}if(typeof m.settings.multiOnTimerWeekday==="string"){m.settings.multiOnTimerWeekday=JSON.parse(m.settings.multiOnTimerWeekday)}if(typeof m.settings.multiOnTimerSource==="string"){m.settings.multiOnTimerSource=JSON.parse(m.settings.multiOnTimerSource)}if(typeof m.settings.onTimerSchedule==="string"){m.settings.onTimerSchedule=JSON.parse(m.settings.onTimerSchedule)}var C=0,A=(m.settings.onTimerSchedule===null||m.settings.onTimerSchedule===undefined?0:m.settings.onTimerSchedule.length);var v=["0","0","0","0","0","0","0"],w=["0","0","0","0","0","0","0"],p=["0","0","0","0","0","0","0"],o=["0","0","0","0","0","0","0"],z=[];var u=c(l.inputSource);for(var y=0;y<r.totalCount;y++){var B=r.devices[y].deviceName;var t=B;var x=l.inputSource.substring(6).split(":");var s="1";if(isNaN(B.substring(B.length-1,B.length))===false){B=B.substring(0,B.length-1);s=r.devices[y].id.split("_")[1]}if(B.toUpperCase()==="DISPLAYPORT"){B="DP"}if(B.toUpperCase().indexOf(x[0].toUpperCase())>=0&&s===x[1]){u=t;break}}var q=false;if(n.webOSVer===3){if(l.week>=64){l.week=1+(l.week-64)*2}else{l.week=l.week*2}}for(var y=0;y<A;y++){h("deleteOnTimer: "+u);if(m.settings.onTimerSchedule[y]===null){continue}h("options.week : "+l.week+" result.settings.onTimerSchedule["+y+"].weekday : "+m.settings.onTimerSchedule[y].weekday);if(q===false&&l.hour===m.settings.onTimerSchedule[y].hour&&l.minute===m.settings.onTimerSchedule[y].minute&&l.week==m.settings.onTimerSchedule[y].weekday&&m.settings.onTimerSchedule[y].input.toUpperCase()===u.toUpperCase()){h("deleteOnTimer: index "+y);q=true}else{v[C]=m.settings.multiOnTimerHour[y];w[C]=m.settings.multiOnTimerMinute[y];p[C]=m.settings.multiOnTimerWeekday[y];o[C]=m.settings.multiOnTimerSource[y];z[C]=m.settings.onTimerSchedule[y];C++}}if(q===true){A--}if(A===0){z=[]}if(m.settings.onTimerSchedule.length===A){if(typeof k==="function"){e(m,"PDOT","Power.deleteOnTimer returns failure. There is no 'on timer' matched in the list.");k(m)}return}a.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"commercial",settings:{multiOnTimerHour:v,multiOnTimerMinute:w,multiOnTimerWeekday:p,multiOnTimerSource:o,onTimerCount:A,onTimerSchedule:z}},onSuccess:function(){h("deleteOnTimer: On Success 2");if(typeof j==="function"){j()}},onFailure:function(D){h("deleteOnTimer: On Failure 2");delete D.returnValue;if(typeof k==="function"){e(D,"PDOT","Power.deleteOnTimer returns failure.");k(D)}}})}},onFailure:function(o){h("getInputSourceStatus: On Failure");delete o.returnValue;if(typeof k==="function"){e(o,"PDOT","Power.deleteOnTimer returns failure");k(o)}return}})})}},onFailure:function(m){h("deleteOnTimer: On Failure");delete m.returnValue;if(typeof k==="function"){e(m,"PDOT","Power.deleteOnTimer returns failure.");k(m)}}});h("Power.deleteOnTimer Done")};b.prototype.addOffTimer=function(j,k,l){h("addOffTimer: "+JSON.stringify(l));if(l.hour===undefined||isNaN(l.hour)||typeof l.hour!=="number"||l.hour<0||l.hour>23||l.minute===undefined||isNaN(l.minute)||typeof l.minute!=="number"||l.minute<0||l.minute>59||l.week===undefined||isNaN(l.week)||typeof l.week!=="number"||l.week<0||l.week>127){if(typeof k==="function"){var i={};e(i,"PAOT","Power.addOffTimer returns failure. Invalid parameter.");k(i)}return}a.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"get",parameters:{category:"commercial",keys:["multiOffTimerHour","multiOffTimerMinute","multiOffTimerWeekday","offTimerSchedule","offTimerCount"]},onSuccess:function(m){if(m.returnValue===true){if(typeof m.settings.multiOffTimerHour==="string"){m.settings.multiOffTimerHour=JSON.parse(m.settings.multiOffTimerHour)}if(typeof m.settings.multiOffTimerMinute==="string"){m.settings.multiOffTimerMinute=JSON.parse(m.settings.multiOffTimerMinute)}if(typeof m.settings.multiOffTimerWeekday==="string"){m.settings.multiOffTimerWeekday=JSON.parse(m.settings.multiOffTimerWeekday)}if(typeof m.settings.offTimerSchedule==="string"){m.settings.offTimerSchedule=JSON.parse(m.settings.offTimerSchedule)}var n=(m.settings.offTimerSchedule===null||m.settings.offTimerSchedule===undefined?0:m.settings.offTimerSchedule.length);if(m.settings.multiOffTimerHour.length<=n){if(typeof k==="function"){e(m,"PAOT","Power.addOffTimer returns failure. No space to add timer.");k(m)}return}f(function(p){h("version : "+p.webOSVer);if(p.webOSVer===3){if(l.week>=64){l.week=1+(l.week-64)*2}else{l.week=l.week*2}}m.settings.multiOffTimerHour[n]=l.hour;m.settings.multiOffTimerMinute[n]=l.minute;m.settings.multiOffTimerWeekday[n]=l.week;h("add hour: "+l.hour+", min : "+l.minute+", week : "+l.week);var o=360;m.settings.offTimerSchedule[n]={_id:""+o++,hour:l.hour,minute:l.minute,weekday:l.week};a.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"commercial",settings:{multiOffTimerHour:m.settings.multiOffTimerHour,multiOffTimerMinute:m.settings.multiOffTimerMinute,multiOffTimerWeekday:m.settings.multiOffTimerWeekday,offTimerCount:n+1,offTimerSchedule:m.settings.offTimerSchedule}},onSuccess:function(){h("addOffTimer: On Success 2");if(typeof j==="function"){j()}},onFailure:function(q){h("addOffTimer: On Failure 2");delete q.returnValue;if(typeof k==="function"){e(q,"PAOT","Power.addOffTimer returns failure.");k(q)}}})})}},onFailure:function(m){h("addOffTimer: On Failure");delete m.returnValue;if(typeof k==="function"){e(m,"PAOT","Power.addOffTimer returns failure.");k(m)}}});h("Power.addOffTimer Done")};b.prototype.deleteOffTimer=function(j,k,l){h("deleteOffTimer: "+JSON.stringify(l));if(l.hour===undefined||isNaN(l.hour)||typeof l.hour!=="number"||l.hour<0||l.hour>23||l.minute===undefined||isNaN(l.minute)||typeof l.minute!=="number"||l.minute<0||l.minute>59||l.week===undefined||isNaN(l.week)||typeof l.week!=="number"||l.week<0||l.week>127){if(typeof k==="function"){var i={};e(i,"PDOT","Power.deleteOffTimer returns failure. invalid parameters or out of range.");k(i)}return}a.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"get",parameters:{category:"commercial",keys:["multiOffTimerHour","multiOffTimerMinute","multiOffTimerWeekday","offTimerSchedule","offTimerCount"]},onSuccess:function(u){if(u.returnValue===true){if(typeof u.settings.multiOffTimerHour==="string"){u.settings.multiOffTimerHour=JSON.parse(u.settings.multiOffTimerHour)}if(typeof u.settings.multiOffTimerMinute==="string"){u.settings.multiOffTimerMinute=JSON.parse(u.settings.multiOffTimerMinute)}if(typeof u.settings.multiOffTimerWeekday==="string"){u.settings.multiOffTimerWeekday=JSON.parse(u.settings.multiOffTimerWeekday)}if(typeof u.settings.offTimerSchedule==="string"){u.settings.offTimerSchedule=JSON.parse(u.settings.offTimerSchedule)}var t=0,s=(u.settings.offTimerSchedule===null||u.settings.offTimerSchedule===undefined?0:u.settings.offTimerSchedule.length);var o=["0","0","0","0","0","0","0"],p=["0","0","0","0","0","0","0"],m=["0","0","0","0","0","0","0"],r=[];var n=false;f(function(v){h("version : "+v.webOSVer);if(v.webOSVer===3){if(l.week>=64){l.week=1+(l.week-64)*2}else{l.week=l.week*2}}});for(var q=0;q<s;q++){if(u.settings.offTimerSchedule[q]===null){continue}h("options.week : "+l.week+" result.settings.offTimerSchedule["+q+"].weekday : "+u.settings.offTimerSchedule[q].weekday);if(n===false&&l.hour===u.settings.offTimerSchedule[q].hour&&l.minute===u.settings.offTimerSchedule[q].minute&&l.week===u.settings.offTimerSchedule[q].weekday){n=true}else{o[t]=u.settings.multiOffTimerHour[q];p[t]=u.settings.multiOffTimerMinute[q];m[t]=u.settings.multiOffTimerWeekday[q];r[t]=u.settings.offTimerSchedule[q];t++}}if(n===true){s--}if(s===0){r=[]}if(u.settings.offTimerSchedule.length===s){if(typeof k==="function"){e(u,"PDOT","Power.deleteOffTimer returns failure. There is no 'off timer' matched in the list.");k(u)}return}a.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"commercial",settings:{multiOffTimerHour:o,multiOffTimerMinute:p,multiOffTimerWeekday:m,offTimerCount:s,offTimerSchedule:r}},onSuccess:function(){h("deleteOffTimer: On Success 2");if(typeof j==="function"){j()}},onFailure:function(v){h("deleteOffTimer: On Failure 2");delete v.returnValue;if(typeof k==="function"){e(v,"PDOT","Power.deleteOffTimer returns failure.");k(v)}}})}},onFailure:function(m){h("deleteOffTimer: On Failure");delete m.returnValue;if(typeof k==="function"){e(m,"PDOT","Power.deleteOffTimer returns failure.");k(m)}}});h("Power.deleteOffTimer Done")};b.prototype.getOnTimerList=function(i,j){h("getOnTimerList: ");a.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"get",parameters:{category:"commercial",keys:["onTimerSchedule"]},onSuccess:function(k){if(k.returnValue===true){f(function(n){h("version : "+n.webOSVer);var o={};if(typeof k.settings.onTimerSchedule==="string"){k.settings.onTimerSchedule=JSON.parse(k.settings.onTimerSchedule)}var t=new Array(k.settings.onTimerSchedule===null||k.settings.onTimerSchedule===undefined?0:k.settings.onTimerSchedule.length);for(var r=0,p=0;p<t.length;p++){if(k.settings.onTimerSchedule[p]===null||k.settings.onTimerSchedule[p]===undefined){continue}t[r]={hour:0,minute:0,week:0,inputSource:0};if(n.webOSVer===3){var l=k.settings.onTimerSchedule[p].weekday;if(l%2){var u=l%2;l=64+((l-u)/2)}else{l=l/2}}else{k.settings.onTimerSchedule[p].weekday}t[r].hour=k.settings.onTimerSchedule[p].hour;t[r].minute=k.settings.onTimerSchedule[p].minute;t[r].week=l;var q="ext://";var s=k.settings.onTimerSchedule[p].input.toUpperCase();var m="1";if(isNaN(s.substring(s.length-1,s.length))===false){m=s.substring(s.length-1,s.length);s=s.substring(0,s.length-1)}s=s.split("/")[0];if(s.toUpperCase()==="DISPLAYPORT"){q=q+"dp:"+m}else{q=q+s.toLowerCase()+":"+m}t[r++].inputSource=q}o.timerList=t;if(typeof i==="function"){i(o)}})}},onFailure:function(k){h("getOnTimerList: On Failure");delete k.returnValue;if(typeof j==="function"){e(k,"PGOTL","Power.getOnTimerList returns failure.");j(k)}}});h("Power.getOnTimerList Done")};b.prototype.getOffTimerList=function(i,j){h("getOffTimerList: ");a.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"get",parameters:{category:"commercial",keys:["offTimerSchedule"]},onSuccess:function(k){h("getOffTimerList: On Success");f(function(q){h("version : "+q.webOSVer);if(k.returnValue===true){var p={};if(typeof k.settings.offTimerSchedule==="string"){k.settings.offTimerSchedule=JSON.parse(k.settings.offTimerSchedule)}var r=new Array(k.settings.offTimerSchedule===null||k.settings.offTimerSchedule===undefined?0:k.settings.offTimerSchedule.length);for(var l=0,m=0;m<r.length;m++){if(k.settings.offTimerSchedule[m]===null||k.settings.offTimerSchedule[m]===undefined){continue}r[l]={hour:0,minute:0,week:0};if(q.webOSVer===3){var n=k.settings.offTimerSchedule[m].weekday;if(n%2){var o=n%2;n=64+((n-o)/2)}else{n=n/2}}else{n=k.settings.offTimerSchedule[m].weekday}r[l].hour=k.settings.offTimerSchedule[m].hour;r[l].minute=k.settings.offTimerSchedule[m].minute;r[l++].week=n}p.timerList=r;if(typeof i==="function"){i(p)}}})},onFailure:function(k){h("getOffTimerList: On Failure");delete k.returnValue;if(typeof j==="function"){e(k,"PGOTL","Power.getOffTimerList returns failure.");j(k)}}});h("Power.getOffTimerList Done")};b.prototype.setDisplayMode=function(j,k,l){h("setDisplayMode: "+JSON.stringify(l));var m=null;switch(l.displayMode){case b.DisplayMode.DISPLAY_OFF:m="turnOffScreen";break;case b.DisplayMode.DISPLAY_ON:m="turnOnScreen";break;default:if(typeof k==="function"){var i={};e(i,"PSDM","Power.setDisplayMode returns failure. Invalid option value.");k(i)}return}h("setDisplayMode: "+m);if(m===null&&typeof k==="function"){var i={};e(i,"PSDM","Power.setDisplayMode returns failure. command was not defined.");k(i);h("Power.setDisplayMode invalid ");return}a.Request("luna://com.webos.service.tv.signage/",{method:"getPowerState",onSuccess:function(n){h("setDisplayMode: On Success");if(n.returnValue===true&&n.state===l.displayMode){if(typeof j==="function"){h("setDisplayMode: no need to do any action.");j()}return}a.Request("luna://com.webos.service.tv.signage/",{method:m,onSuccess:function(o){h("setDisplayMode: On Success");if(o.returnValue===true){if(typeof j==="function"){j()}}},onFailure:function(o){h("setDisplayMode: On Failure");delete o.returnValue;if(typeof k==="function"){e(o,"PSDM","Power.setDisplayMode returns failure.");k(o)}}})},onFailure:function(n){h("setDisplayMode: On Failure 2");delete n.returnValue;if(typeof k==="function"){e(n,"PSDM","Power.setDisplayMode returns failure.");k(n)}}});h("Power.setDisplayMode Done")};b.prototype.executePowerCommand=function(j,k,l){h("executePowerCommand: "+JSON.stringify(l));if(l.powerCommand===undefined||typeof l.powerCommand!=="string"||l.powerCommand===null||l.powerCommand.length<=0){if(typeof k==="function"){var i={};e(i,"PEPM","Power.executePowerCommand returns failure. invalid argument or out of range. ");k(i)}return}if((l.powerCommand!==b.PowerCommand.REBOOT)&&(l.powerCommand!==b.PowerCommand.SHUTDOWN)){var i={};e(i,"PEPM","Power.executePowerCommand returns failure. invalid argument.");k(i);return}a.Request("luna://com.webos.service.tv.signage/",{method:l.powerCommand,parameters:{reason:"unknown"},onSuccess:function(m){h("executePowerCommand: On Success");if(m.returnValue===true){if(typeof j==="function"){j()}}},onFailure:function(m){h("executePowerCommand: On Failure");delete m.returnValue;if(typeof k==="function"){e(m,"PEPM","Power.executePowerCommand returns failure.");k(m)}}});h("Power.executePowerCommand Done")};b.prototype.setDPMWakeup=function(j,l,m){var k=null;switch(m.dpmSignalType){case b.DPMSignalType.CLOCK:k="clock";break;case b.DPMSignalType.CLOCK_WITH_DATA:k="clockAndData";break}h("setDPMWakeup: "+k);if(k===null&&typeof l==="function"){var i={};e(i,"PSDW","Power.setDPMWakeup returns failure. command was not defined.");l(i);h("Power.setDPMWakeup invalid ");return}a.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"commercial",settings:{dpmWakeUpControl:k}},onSuccess:function(n){h("setDPMWakeup: On Success");if(n.returnValue===true){if(typeof j==="function"){j()}}},onFailure:function(n){h("setDPMWakeup: On Failure");delete n.returnValue;if(typeof l==="function"){e(n,"PSDW","Power.setDPMWakeup returns failure.");l(n)}}});h("Power.setDPMWakeup Done")};b.prototype.getDPMWakeup=function(i,j){h("getDPMWakeup: ");a.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"get",parameters:{category:"commercial",keys:["dpmWakeUpControl"]},onSuccess:function(k){h("getDPMWakeup: On Success");if(k.returnValue===true){var l={};l.dpmSignalType=k.settings.dpmWakeUpControl;if(typeof i==="function"){i(l)}}},onFailure:function(k){h("getDPMWakeup: On Failure");delete k.returnValue;if(typeof j==="function"){e(k,"PGDW","Power.getDPMWakeup returns failure.");j(k)}}});h("Power.getDPMWakeup Done")};b.prototype.setPMMode=function(j,k,l){var m=null;switch(l.mode){case b.PMMode.PowerOff:m="powerOff";break;case b.PMMode.SustainAspectRatio:m="sustainAspectRatio";break;case b.PMMode.ScreenOff:m="screenOff";break;case b.PMMode.ScreenOffAlways:m="screenOffAlways";break;case b.PMMode.ScreenOffBacklight:m="screenOffBacklight";break}h("setPMMode: "+m);if(m===null&&typeof k==="function"){var i={};e(i,"PSPM","Power.setPMMode returns failure. command was not defined.");k(i);h("Power.setPMMode invalid ");return}a.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"commercial",settings:{pmMode:m}},onSuccess:function(n){h("setPMMode: On Success");if(n.returnValue===true){if(typeof j==="function"){j()}}},onFailure:function(n){h("setPMMode: On Failure");delete n.returnValue;if(typeof k==="function"){e(n,"PSPM","Power.setPMMode returns failure.");k(n)}}});h("Power.setPMMode Done")};b.prototype.getPMMode=function(i,j){h("getPMMode: ");a.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"get",parameters:{category:"commercial",keys:["pmMode"]},onSuccess:function(k){h("getPMMode: On Success");if(k.returnValue===true){var l={};l.mode=k.settings.pmMode;if(typeof i==="function"){i(l)}}},onFailure:function(k){h("getPMMode: On Failure");delete k.returnValue;if(typeof j==="function"){e(k,"PGPM","Power.getPMMode returns failure.");j(k)}}});h("Power.getPMMode Done")};b.prototype.setPowerOnDelay=function(j,k,l){h("setPowerOnDelay: "+l.delayTime);if(l.delayTime===null&&typeof k==="function"){var i={};e(i,"PSPD","Power.setPowerOnDelay returns failure. command was not defined.");k(i);h("Power.setPowerOnDelay invalid ");return}if(typeof l.delayTime!=="number"){var i={};e(i,"PSPD","Power.setPowerOnDelay returns failure. delayTime is not a number.");k(i);h("Power.setPowerOnDelay invalid type");return}if((l.delayTime<0)||(l.delayTime>250)){var i={};e(i,"PSPD","Power.setPowerOnDelay returns failure. Out of range.");k(i);h("Power.setPowerOnDelay invalid range");return}a.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"commercial",settings:{powerOnDelay:l.delayTime}},onSuccess:function(m){h("setPowerOnDelay: On Success");if(m.returnValue===true){if(typeof j==="function"){j()}}},onFailure:function(m){h("setPowerOnDelay: On Failure");delete m.returnValue;if(typeof k==="function"){e(m,"PSPD","Power.setPowerOnDelay returns failure.");k(m)}}});h("Power.setPowerOnDelay Done")};b.prototype.getPowerOnDelay=function(i,j){h("getPowerOnDelay: ");a.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"get",parameters:{category:"commercial",keys:["powerOnDelay"]},onSuccess:function(k){h("getPowerOnDelay: On Success");if(k.returnValue===true){var l={};l.delayTime=k.settings.powerOnDelay;if(typeof i==="function"){i(l)}}},onFailure:function(k){h("getPowerOnDelay: On Failure");delete k.returnValue;if(typeof j==="function"){e(k,"PGPD","Power.getPowerOnDelay returns failure.");j(k)}}});h("Power.getPowerOnDelay Done")};b.prototype.getOnOffTimeSchedule=function(i,j){h("getOnOffTimeSchedule: ");a.Request("luna://com.webos.service.commercial.signage.storageservice/",{method:"getOnOffTimeSchedule",parameters:{},onSuccess:function(k){h("getOnOffTimeSchedule: On Success");if(k.returnValue===true){if(typeof i==="function"){var l={};l.onOffTimeScheduleList=k.settings.onOffTimeSchedule;if(typeof i==="function"){i(l)}}}},onFailure:function(k){h("getOnOffTimeSchedule: On Failure");delete k.returnValue;if(typeof j==="function"){e(k,"TGAS","Power.getOnOffTimeSchedule returns failure.");j(k)}}});h("Power.getOnOffTimeSchedule Done")};b.prototype.setOnOffTimeSchedule=function(i,j,k){h("setOnOffTimeSchedule: ");a.Request("luna://com.webos.service.commercial.signage.storageservice/",{method:"setOnOffTimeSchedule",parameters:k,onSuccess:function(l){h("setOnOffTimeSchedule: On Success");if(l.returnValue===true){if(typeof i==="function"){if(typeof i==="function"){i()}}}},onFailure:function(l){h("setOnOffTimeSchedule: On Failure");delete l.returnValue;if(typeof j==="function"){e(l,"TGAS","Power.setOnOffTimeSchedule returns failure.");j(l)}}});h("Power.setOnOffTimeSchedule Done")};b.prototype.unsetOnOffTimeSchedule=function(i,j){h("unsetOnOffTimeSchedule: ");a.Request("luna://com.webos.service.commercial.signage.storageservice/",{method:"unsetOnOffTimeSchedule",parameters:{},onSuccess:function(k){h("unsetOnOffTimeSchedule: On Success");if(k.returnValue===true){if(typeof i==="function"){if(typeof i==="function"){i()}}}},onFailure:function(k){h("unsetOnOffTimeSchedule: On Failure");delete k.returnValue;if(typeof j==="function"){e(k,"TGAS","Power.unsetOnOffTimeSchedule returns failure.");j(k)}}});h("Power.unsetHolidaySchedule Done")};return b}());