Power=function(){var s,y;function w(e,t,n){void 0!==e.errorCode&&null!==e.errorCode||(e.errorCode=t),void 0!==e.errorText&&null!==e.errorText||(e.errorText=n)}function d(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!=t.length)return!1;e.sort(),t.sort();for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}"object"==typeof window?(cordova.define("cordova/plugin/power",function(e,t,n){s=function(){},y=window.PalmSystem?e("cordova/plugin/webos/service"):{Request:function(e,t){"function"==typeof t.onFailure&&t.onFailure({returnValue:!1,errorText:"PalmSystem Not Available. Cordova is not installed?"})}},n.exports=s}),s=cordova.require("cordova/plugin/power")):(s=function(e){(y=e).Request=function(e,t){var n=e+"/"+t.method,i={};!0===t.hasOwnProperty("parameters")&&(i=t.parameters);var o={};y&&y.call(n,i,function(e){console.log("res : "+JSON.stringify(e)),!0===e.payload.returnValue?(o=e.payload,t.onSuccess(o)):(o.returnValue=!1,o.errorCode=e.payload.errorCode,o.errorText=e.payload.errorText,t.onFailure(o))})}},module.exports=s);var r=null,v={};function T(n){null===r?y.Request("luna://com.webos.service.tv.systemproperty",{method:"getSystemInfo",parameters:{keys:["sdkVersion","boardType"]},onSuccess:function(e){e.sdkVersion;var t=e.sdkVersion.split(".");v=1<=t.length&&"1"===t[0]?{webOSVer:1,chipset:e.boardType.split("_")[0]}:1<=t.length&&"2"===t[0]?{webOSVer:2,chipset:e.boardType.split("_")[0]}:1<=t.length&&"3"===t[0]?{webOSVer:3,chipset:e.boardType.split("_")[0]}:1<=t.length&&"4"===t[0]?{webOSVer:4,chipset:e.boardType.split("_")[0]}:{webOSVer:0,chipset:""},r=v.webOSVer,delete e.returnValue,n(v)},onFailure:function(e){delete e.returnValue,n(v={webOSVer:0,chipset:""})}}):n(v)}return s.PowerCommand={SHUTDOWN:"powerOff",REBOOT:"reboot"},s.DisplayMode={DISPLAY_OFF:"Screen Off",DISPLAY_ON:"Active"},s.TimerWeek={MONDAY:1,TUESDAY:2,WEDNESDAY:4,THURSDAY:8,FRIDAY:16,SATURDAY:32,SUNDAY:64,EVERYDAY:127},s.DPMSignalType={CLOCK:"clock",CLOCK_WITH_DATA:"clockAndData"},s.PMMode={PowerOff:"powerOff",SustainAspectRatio:"sustainAspectRatio",ScreenOff:"screenOff",ScreenOffAlways:"screenOffAlways",ScreenOffBacklight:"screenOffBacklight"},s.prototype.getPowerStatus=function(n,i){T(function(e){4===e.webOSVer||4<e.webOSVer?y.Request("luna://com.webos.service.commercial.scapadapter/power/",{method:"getPowerStatus",parameters:{},onSuccess:function(e){delete e.returnValue,"function"==typeof n&&n(e)},onFailure:function(e){delete e.returnValue,"function"==typeof i&&(w(e,"PGPS","Power.getPowerStatus returns failure."),i(e))}}):y.Request("luna://com.webos.service.tv.signage/",{method:"getPowerState",onSuccess:function(e){var t={};!0===e.returnValue&&(t.displayMode=e.state),y.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"get",parameters:{category:"commercial",keys:["wolEnable"]},onSuccess:function(e){!0===e.returnValue&&(t.wakeOnLan="1"===e.settings.wolEnable),y.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"get",parameters:{category:"time",keys:["onTimerEnable","offTimerEnable"]},onSuccess:function(e){!0===e.returnValue&&(t.allOnTimer="on"===e.settings.onTimerEnable,t.allOffTimer="on"===e.settings.offTimerEnable,"function"==typeof n&&n(t))},onFailure:function(e){delete e.returnValue,"function"==typeof i&&(w(e,"PGPS","Power.getPowerStatus returns failure."),i(e))}})},onFailure:function(e){delete e.returnValue,"function"==typeof i&&(w(e,"PGPS","Power.getPowerStatus returns failure."),i(e))}})},onFailure:function(e){delete e.returnValue,"function"==typeof i&&(w(e,"PGPS","Power.getPowerStatus returns failure."),i(e))}})})},s.prototype.enableAllOnTimer=function(r,u,t){JSON.stringify(t);var n=null;switch(t.allOnTimer){case!0:n="on";break;case!1:n="off";break;default:if("function"==typeof u){var e={};w(e,"PEAOT","Power.enableAllOnTimer returns failure. Invalid option value."),u(e)}return}T(function(e){4===e.webOSVer||4<e.webOSVer?y.Request("luna://com.webos.service.commercial.scapadapter/settings/",{method:"set",parameters:{category:"time",settings:{onTimerEnable:n}},onSuccess:function(){!0===t.clearOnTimer?y.Request("luna://com.webos.service.commercial.scapadapter/settings/",{method:"get",parameters:{category:"commercial",keys:["onOffTimeSchedule"]},onSuccess:function(e){if(!0===e.returnValue){var t=0,n={onTime:[],offTime:[]},i={},o=null===e.settings.onOffTimeSchedule.offTime||void 0===e.settings.onOffTimeSchedule.offTime?0:e.settings.onOffTimeSchedule.offTime.length;for(t=0;t<o;t++)void 0!==e.settings.onOffTimeSchedule.offTime[t].day&&null!==e.settings.onOffTimeSchedule.offTime[t].day&&(i.day=e.settings.onOffTimeSchedule.offTime[t].day),void 0!==e.settings.onOffTimeSchedule.offTime[t].hour&&null!==e.settings.onOffTimeSchedule.offTime[t].hour&&(i.hour=e.settings.onOffTimeSchedule.offTime[t].hour),void 0!==e.settings.onOffTimeSchedule.offTime[t].minute&&null!==e.settings.onOffTimeSchedule.offTime[t].minute&&(i.minute=e.settings.onOffTimeSchedule.offTime[t].minute),n.offTime.push(i),i={};y.Request("luna://com.webos.service.commercial.scapadapter/settings/",{method:"set",parameters:{category:"commercial",settings:{onOffTimeSchedule:n}},onSuccess:function(){"function"==typeof r&&r()},onFailure:function(e){delete e.returnValue,"function"==typeof u&&(w(e,"PAOT","Power.enableAllOnTimer returns failure."),u(e))}})}else"function"==typeof r&&r()},onFailure:function(e){delete e.returnValue,"function"==typeof u&&(w(e,"PEAOT","Power.enableAllOnTimer returns failure."),u(e))}}):"function"==typeof r&&r()},onFailure:function(e){delete e.returnValue,"function"==typeof u&&(w(e,"PEAOT","Power.enableAllOnTimer returns failure."),u(e))}}):y.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"time",settings:{onTimerEnable:n}},onSuccess:function(){if(!0===t.clearOnTimer){y.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"commercial",settings:{multiOnTimerHour:["0","0","0","0","0","0","0"],multiOnTimerMinute:["0","0","0","0","0","0","0"],multiOnTimerWeekday:["0","0","0","0","0","0","0"],multiOnTimerSource:["0","0","0","0","0","0","0"],onTimerCount:0,onTimerSchedule:[]}},onSuccess:function(){"function"==typeof r&&r()},onFailure:function(e){delete e.returnValue,"function"==typeof u&&(w(e,"PEAOT","Power.enableAllOnTimer returns failure. / clearOnTimer"),u(e))}})}else"function"==typeof r&&r()},onFailure:function(e){delete e.returnValue,"function"==typeof u&&(w(e,"PEAOT","Power.enableAllOnTimer returns failure."),u(e))}})})},s.prototype.enableAllOffTimer=function(r,u,t){JSON.stringify(t);var n=null;switch(t.allOffTimer){case!0:n="on";break;case!1:n="off";break;default:if("function"==typeof u){var e={};w(e,"PEAOT","Power.enableAllOffTimer returns failure. Invalid option value."),u(e)}return}T(function(e){4===e.webOSVer||4<e.webOSVer?y.Request("luna://com.webos.service.commercial.scapadapter/settings/",{method:"set",parameters:{category:"time",settings:{offTimerEnable:n}},onSuccess:function(){!0===t.clearOffTimer?y.Request("luna://com.webos.service.commercial.scapadapter/settings/",{method:"get",parameters:{category:"commercial",keys:["onOffTimeSchedule"]},onSuccess:function(e){if(!0===e.returnValue){var t=0,n={onTime:[],offTime:[]},i={},o=null===e.settings.onOffTimeSchedule.onTime||void 0===e.settings.onOffTimeSchedule.onTime?0:e.settings.onOffTimeSchedule.onTime.length;for(t=0;t<o;t++)void 0!==e.settings.onOffTimeSchedule.onTime[t].day&&null!==e.settings.onOffTimeSchedule.onTime[t].day&&(i.day=e.settings.onOffTimeSchedule.onTime[t].day),void 0!==e.settings.onOffTimeSchedule.onTime[t].hour&&null!==e.settings.onOffTimeSchedule.onTime[t].hour&&(i.hour=e.settings.onOffTimeSchedule.onTime[t].hour),void 0!==e.settings.onOffTimeSchedule.onTime[t].minute&&null!==e.settings.onOffTimeSchedule.onTime[t].minute&&(i.minute=e.settings.onOffTimeSchedule.onTime[t].minute),n.onTime.push(i),i={};y.Request("luna://com.webos.service.commercial.scapadapter/settings/",{method:"set",parameters:{category:"commercial",settings:{onOffTimeSchedule:n}},onSuccess:function(){"function"==typeof r&&r()},onFailure:function(e){delete e.returnValue,"function"==typeof u&&(w(e,"PAOT","Power.enableAllOffTimer returns failure."),u(e))}})}else"function"==typeof r&&r()},onFailure:function(e){delete e.returnValue,"function"==typeof u&&(w(e,"PEAOT","Power.enableAllOffTimer returns failure."),u(e))}}):"function"==typeof r&&r()},onFailure:function(e){delete e.returnValue,"function"==typeof u&&(w(e,"PEAOT","Power.enableAllOffTimer returns failure."),u(e))}}):y.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"time",settings:{offTimerEnable:n}},onSuccess:function(){if(!0===t.clearOffTimer){y.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"commercial",settings:{multiOffTimerHour:["0","0","0","0","0","0","0"],multiOffTimerMinute:["0","0","0","0","0","0","0"],multiOffTimerWeekday:["0","0","0","0","0","0","0"],offTimerCount:0,offTimerSchedule:[]}},onSuccess:function(){"function"==typeof r&&r()},onFailure:function(e){delete e.returnValue,"function"==typeof u&&(w(e,"PEAOT","Power.enableAllOffTimer returns failure. / clearOffTimer"),u(e))}})}else"function"==typeof r&&r()},onFailure:function(e){delete e.returnValue,"function"==typeof u&&(w(e,"PEAOT","Power.enableAllOffTimer returns failure."),u(e))}})})},s.prototype.enableWakeOnLan=function(e,t,n){JSON.stringify(n);var i=null;switch(n.wakeOnLan){case!0:i="1";break;case!1:i="0";break;default:if("function"==typeof t){var o={};w(o,"PSWOL","Power.enableWakeOnLan returns failure. Invalid option value."),t(o)}return}y.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"commercial",settings:{wolEnable:i}},onSuccess:function(){"function"==typeof e&&e()},onFailure:function(e){delete e.returnValue,"function"==typeof t&&(w(e,"PSWOL","Power.enableWakeOnLan returns failure."),t(e))}})},s.prototype.addOnTimer=function(f,m,a){JSON.stringify(a),T(function(s){if(4===s.webOSVer||4<s.webOSVer){if(void 0===a.hour||isNaN(a.hour)||"number"!=typeof a.hour||a.hour<0||23<a.hour||void 0===a.minute||isNaN(a.minute)||"number"!=typeof a.minute||a.minute<0||59<a.minute||void 0===a.week||isNaN(a.week)||"number"!=typeof a.week||a.week<=0||127<a.week){if("function"==typeof m)w(e={},"PAOT","Power.addOnTimer returns failure. invalid parameters or out of range."),m(e);return}y.Request("luna://com.webos.service.commercial.scapadapter/settings/",{method:"get",parameters:{category:"commercial",keys:["onOffTimeSchedule"]},onSuccess:function(e){if(!0===e.returnValue){for(var t=0,n={onTime:[],offTime:[]},i=[],o={},r=1;0!==a.week;){if(1&a.week)switch(console.log("AddonTimer - options.week - "+a.week),r){case 1:i.push("mon");break;case 2:i.push("tue");break;case 4:i.push("wed");break;case 8:i.push("thu");break;case 16:i.push("fri");break;case 32:i.push("sat");break;case 64:i.push("sun")}if(a.week=a.week>>>1,r<<=1,0===a.week)break}o.day=i,o.hour=a.hour,o.minute=a.minute,n.onTime.push(o),o={};var u=null===e.settings.onOffTimeSchedule.onTime||void 0===e.settings.onOffTimeSchedule.onTime?0:e.settings.onOffTimeSchedule.onTime.length;for(t=0;t<u;t++)void 0!==e.settings.onOffTimeSchedule.onTime[t].day&&null!==e.settings.onOffTimeSchedule.onTime[t].day&&(o.day=e.settings.onOffTimeSchedule.onTime[t].day),void 0!==e.settings.onOffTimeSchedule.onTime[t].hour&&null!==e.settings.onOffTimeSchedule.onTime[t].hour&&(o.hour=e.settings.onOffTimeSchedule.onTime[t].hour),void 0!==e.settings.onOffTimeSchedule.onTime[t].minute&&null!==e.settings.onOffTimeSchedule.onTime[t].minute&&(o.minute=e.settings.onOffTimeSchedule.onTime[t].minute),n.onTime.push(o),o={};var s=null===e.settings.onOffTimeSchedule.offTime||void 0===e.settings.onOffTimeSchedule.offTime?0:e.settings.onOffTimeSchedule.offTime.length;for(t=0;t<s;t++)void 0!==e.settings.onOffTimeSchedule.offTime[t].day&&null!==e.settings.onOffTimeSchedule.offTime[t].day&&(o.day=e.settings.onOffTimeSchedule.offTime[t].day),void 0!==e.settings.onOffTimeSchedule.offTime[t].hour&&null!==e.settings.onOffTimeSchedule.offTime[t].hour&&(o.hour=e.settings.onOffTimeSchedule.offTime[t].hour),void 0!==e.settings.onOffTimeSchedule.offTime[t].minute&&null!==e.settings.onOffTimeSchedule.offTime[t].minute&&(o.minute=e.settings.onOffTimeSchedule.offTime[t].minute),n.offTime.push(o),o={};y.Request("luna://com.webos.service.commercial.scapadapter/settings/",{method:"set",parameters:{category:"commercial",settings:{onOffTimeSchedule:n}},onSuccess:function(){"function"==typeof f&&f()},onFailure:function(e){delete e.returnValue,"function"==typeof m&&(w(e,"PAOT","Power.addOnTimer returns failure."),m(e))}})}},onFailure:function(e){delete e.returnValue,"function"==typeof m&&(w(e,"PAOT","Power.addOnTimer returns failure."),m(e))}})}else{if(void 0===a.hour||isNaN(a.hour)||"number"!=typeof a.hour||a.hour<0||23<a.hour||void 0===a.minute||isNaN(a.minute)||"number"!=typeof a.minute||a.minute<0||59<a.minute||void 0===a.week||isNaN(a.week)||"number"!=typeof a.week||a.week<0||127<a.week||void 0===a.inputSource||"string"!=typeof a.inputSource||0!==a.inputSource.indexOf("ext://")){var e;if("function"==typeof m)w(e={},"PAOT","Power.addOnTimer returns failure. invalid parameters or out of range."),m(e);return}y.Request("luna://com.webos.service.eim/",{method:"getAllInputStatus",onSuccess:function(e){if(!0===e.returnValue){for(var t=!1,n=0;n<e.totalCount;n++){var i=e.devices[n].deviceName.toLowerCase(),o=i,r=a.inputSource.substring(6).split(":"),u="1";if(!1===isNaN(i.substring(i.length-1,i.length))&&(i=i.substring(0,i.length-1),u=e.devices[n].id.split("_")[1]),"DISPLAYPORT"===i.toUpperCase()&&(i="DP"),0<=i.toUpperCase().indexOf(r[0].toUpperCase())&&u===r[1]){t=!0;break}}if(!1===t)return delete e.returnValue,void("function"==typeof m&&(w(e,"PAOT","Power.addOnTimer returns failure."),m(e)));y.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"get",parameters:{category:"commercial",keys:["multiOnTimerHour","multiOnTimerMinute","multiOnTimerWeekday","multiOnTimerSource","onTimerSchedule","onTimerCount"]},onSuccess:function(e){if(!0===e.returnValue){s.webOSVer,"string"==typeof e.settings.multiOnTimerHour&&(e.settings.multiOnTimerHour=JSON.parse(e.settings.multiOnTimerHour)),"string"==typeof e.settings.multiOnTimerMinute&&(e.settings.multiOnTimerMinute=JSON.parse(e.settings.multiOnTimerMinute)),"string"==typeof e.settings.multiOnTimerWeekday&&(e.settings.multiOnTimerWeekday=JSON.parse(e.settings.multiOnTimerWeekday)),"string"==typeof e.settings.multiOnTimerSource&&(e.settings.multiOnTimerSource=JSON.parse(e.settings.multiOnTimerSource)),"string"==typeof e.settings.onTimerSchedule&&(e.settings.onTimerSchedule=JSON.parse(e.settings.onTimerSchedule));var t=null===e.settings.onTimerSchedule||void 0===e.settings.onTimerSchedule?0:e.settings.onTimerSchedule.length;if(e.settings.multiOnTimerHour.length<=t)return void("function"==typeof m&&(w(e,"PSOT","Power.addOnTimer returns failure. No space to add timer."),m(e)));3===s.webOSVer&&(64<=a.week?a.week=1+2*(a.week-64):a.week=2*a.week),e.settings.multiOnTimerHour[t]=a.hour,e.settings.multiOnTimerMinute[t]=a.minute,e.settings.multiOnTimerWeekday[t]=a.week,e.settings.multiOnTimerSource[t]=o.toUpperCase();var n=360;e.settings.onTimerSchedule[t]={_id:""+n++,hour:a.hour,input:o.toUpperCase(),minute:a.minute,weekday:a.week},y.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"commercial",settings:{multiOnTimerHour:e.settings.multiOnTimerHour,multiOnTimerMinute:e.settings.multiOnTimerMinute,multiOnTimerWeekday:e.settings.multiOnTimerWeekday,multiOnTimerSource:e.settings.multiOnTimerSource,onTimerCount:t+1,onTimerSchedule:e.settings.onTimerSchedule}},onSuccess:function(){"function"==typeof f&&f()},onFailure:function(e){delete e.returnValue,"function"==typeof m&&(w(e,"PAOT","Power.addOnTimer returns failure."),m(e))}})}},onFailure:function(e){delete e.returnValue,"function"==typeof m&&(w(e,"PAOT","Power.addOnTimer returns failure."),m(e))}})}},onFailure:function(e){delete e.returnValue,"function"==typeof m&&(w(e,"PAOT","Power.addOnTimer returns failure on gathering input list."),m(e))}})}})},s.prototype.deleteOnTimer=function(O,p,S){JSON.stringify(S),T(function(e){if(4===e.webOSVer||4<e.webOSVer){if(void 0===S.hour||isNaN(S.hour)||"number"!=typeof S.hour||S.hour<0||23<S.hour||void 0===S.minute||isNaN(S.minute)||"number"!=typeof S.minute||S.minute<0||59<S.minute||void 0===S.week||isNaN(S.week)||"number"!=typeof S.week||S.week<0||127<S.week){if("function"==typeof p)w(t={},"PAOT","Power.deleteOnTimer returns failure. invalid parameters or out of range."),p(t);return}y.Request("luna://com.webos.service.commercial.scapadapter/settings/",{method:"get",parameters:{category:"commercial",keys:["onOffTimeSchedule"]},onSuccess:function(e){if(!0===e.returnValue){for(var t=0,n={onTime:[],offTime:[]},i=[],o={},r={},u=1;0!==S.week;){if(1&S.week)switch(u){case 1:i.push("mon");break;case 2:i.push("tue");break;case 4:i.push("wed");break;case 8:i.push("thu");break;case 16:i.push("fri");break;case 32:i.push("sat");break;case 64:i.push("sun")}if(S.week=S.week>>>1,u<<=1,0===S.week)break}u=0,o.day=i,o.hour=S.hour,o.minute=S.minute;var s=null===e.settings.onOffTimeSchedule.onTime||void 0===e.settings.onOffTimeSchedule.onTime?0:e.settings.onOffTimeSchedule.onTime.length,f=!1;for(t=0;t<s;t++)void 0!==e.settings.onOffTimeSchedule.onTime[t].day&&null!==e.settings.onOffTimeSchedule.onTime[t].day&&(d(e.settings.onOffTimeSchedule.onTime[t].day,o.day)?u++:r.day=e.settings.onOffTimeSchedule.onTime[t].day),void 0!==e.settings.onOffTimeSchedule.onTime[t].hour&&null!==e.settings.onOffTimeSchedule.onTime[t].hour&&(e.settings.onOffTimeSchedule.onTime[t].hour===o.hour?u++:r.hour=e.settings.onOffTimeSchedule.onTime[t].hour),void 0!==e.settings.onOffTimeSchedule.onTime[t].minute&&null!==e.settings.onOffTimeSchedule.onTime[t].minute&&(e.settings.onOffTimeSchedule.onTime[t].minute===o.minute?u++:r.minute=e.settings.onOffTimeSchedule.onTime[t].minute),3!==u?n.onTime.push(r):f=!0,u=0,r={};var m=null===e.settings.onOffTimeSchedule.offTime||void 0===e.settings.onOffTimeSchedule.offTime?0:e.settings.onOffTimeSchedule.offTime.length;for(t=0;t<m;t++)void 0!==e.settings.onOffTimeSchedule.offTime[t].day&&null!==e.settings.onOffTimeSchedule.offTime[t].day&&(r.day=e.settings.onOffTimeSchedule.offTime[t].day),void 0!==e.settings.onOffTimeSchedule.offTime[t].hour&&null!==e.settings.onOffTimeSchedule.offTime[t].hour&&(r.hour=e.settings.onOffTimeSchedule.offTime[t].hour),void 0!==e.settings.onOffTimeSchedule.offTime[t].minute&&null!==e.settings.onOffTimeSchedule.offTime[t].minute&&(r.minute=e.settings.onOffTimeSchedule.offTime[t].minute),n.offTime.push(r),r={};if(f)y.Request("luna://com.webos.service.commercial.scapadapter/settings/",{method:"set",parameters:{category:"commercial",settings:{onOffTimeSchedule:n}},onSuccess:function(){"function"==typeof O&&O()},onFailure:function(e){delete e.returnValue,"function"==typeof p&&(w(e,"PAOT","Power.deleteOnTimer returns failure."),p(e))}});else w(e={},"PAOT","Power.deleteOnTimer returns failure. / No matched found"),p(e)}},onFailure:function(e){delete e.returnValue,"function"==typeof p&&(w(e,"PAOT","Power.deleteOnTimer returns failure."),p(e))}})}else{if(void 0===S.hour||isNaN(S.hour)||"number"!=typeof S.hour||S.hour<0||23<S.hour||void 0===S.minute||isNaN(S.minute)||"number"!=typeof S.minute||S.minute<0||59<S.minute||void 0===S.week||isNaN(S.week)||"number"!=typeof S.week||S.week<0||127<S.week||void 0===S.inputSource||"string"!=typeof S.inputSource||0!==S.inputSource.indexOf("ext://")){var t;if("function"==typeof p)w(t={},"PDOT","Power.deleteOnTimer returns failure. invalid parameters or out of range."),p(t);return}y.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"get",parameters:{category:"commercial",keys:["multiOnTimerHour","multiOnTimerMinute","multiOnTimerWeekday","multiOnTimerSource","onTimerSchedule","onTimerCount"]},onSuccess:function(h){!0===h.returnValue&&T(function(g){y.Request("luna://com.webos.service.eim/",{method:"getAllInputStatus",onSuccess:function(e){if(!0===h.returnValue){g.webOSVer,"string"==typeof h.settings.multiOnTimerHour&&(h.settings.multiOnTimerHour=JSON.parse(h.settings.multiOnTimerHour)),"string"==typeof h.settings.multiOnTimerMinute&&(h.settings.multiOnTimerMinute=JSON.parse(h.settings.multiOnTimerMinute)),"string"==typeof h.settings.multiOnTimerWeekday&&(h.settings.multiOnTimerWeekday=JSON.parse(h.settings.multiOnTimerWeekday)),"string"==typeof h.settings.multiOnTimerSource&&(h.settings.multiOnTimerSource=JSON.parse(h.settings.multiOnTimerSource)),"string"==typeof h.settings.onTimerSchedule&&(h.settings.onTimerSchedule=JSON.parse(h.settings.onTimerSchedule));for(var t=0,n=null===h.settings.onTimerSchedule||void 0===h.settings.onTimerSchedule?0:h.settings.onTimerSchedule.length,i=["0","0","0","0","0","0","0"],o=["0","0","0","0","0","0","0"],r=["0","0","0","0","0","0","0"],u=["0","0","0","0","0","0","0"],s=[],f=function(e){if("H15"==v.chipset)switch(e){case"ext://hdmi:1":return"HDMI1";case"ext://hdmi:2":return"HDMI2";case"ext://hdmi:3":case"ext://dvi:1":return"OPS/HDMI3/DVI";case"ext://dp:1":return"DISPLAYPORT";case"ext://rgb:1":return"RGB";case"ext://ops:1":return"OPS/HDMI3/DVI";case"HDMI1":return"ext://hdmi:1";case"HDMI2":return"ext://hdmi:2";case"HDMI3":return"ext://hdmi:3";case"DVI":return"ext://dvi:1";case"DISPLAYPORT":return"ext://dp:1";case"RGB":return"ext://rgb:1";case"OPS":return"ext://ops:1";case"OPS/HDMI3/DVI":return"ext://hdmi:3"}else switch(e){case"ext://hdmi:1":return"HDMI1";case"ext://hdmi:2":return"HDMI2";case"ext://hdmi:3":return"HDMI3";case"ext://dvi:1":return"DVI";case"ext://dp:1":return"DISPLAYPORT";case"ext://rgb:1":return"RGB";case"ext://ops:1":return"OPS";case"HDMI1":case"HDMI":return"ext://hdmi:1";case"HDMI2":return"ext://hdmi:2";case"HDMI3":return"ext://hdmi:3";case"DVI":return"ext://dvi:1";case"DISPLAYPORT":return"ext://dp:1";case"RGB":return"ext://rgb:1";case"OPS":return"ext://ops:1";case"OPS/HDMI3/DVI":return"ext://hdmi:3"}return null}(S.inputSource),m=0;m<e.totalCount;m++){var a=e.devices[m].deviceName,l=a,c=S.inputSource.substring(6).split(":"),d="1";if(!1===isNaN(a.substring(a.length-1,a.length))&&(a=a.substring(0,a.length-1),d=e.devices[m].id.split("_")[1]),"DISPLAYPORT"===a.toUpperCase()&&(a="DP"),0<=a.toUpperCase().indexOf(c[0].toUpperCase())&&d===c[1]){f=l;break}}var T=!1;3===g.webOSVer&&(64<=S.week?S.week=1+2*(S.week-64):S.week=2*S.week);for(m=0;m<n;m++)null!==h.settings.onTimerSchedule[m]&&(S.week,h.settings.onTimerSchedule[m].weekday,!1===T&&S.hour===h.settings.onTimerSchedule[m].hour&&S.minute===h.settings.onTimerSchedule[m].minute&&S.week==h.settings.onTimerSchedule[m].weekday&&h.settings.onTimerSchedule[m].input.toUpperCase()===f.toUpperCase()?T=!0:(i[t]=h.settings.multiOnTimerHour[m],o[t]=h.settings.multiOnTimerMinute[m],r[t]=h.settings.multiOnTimerWeekday[m],u[t]=h.settings.multiOnTimerSource[m],s[t]=h.settings.onTimerSchedule[m],t++));if(!0===T&&n--,0===n&&(s=[]),h.settings.onTimerSchedule.length===n)return void("function"==typeof p&&(w(h,"PDOT","Power.deleteOnTimer returns failure. There is no 'on timer' matched in the list."),p(h)));y.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"commercial",settings:{multiOnTimerHour:i,multiOnTimerMinute:o,multiOnTimerWeekday:r,multiOnTimerSource:u,onTimerCount:n,onTimerSchedule:s}},onSuccess:function(){"function"==typeof O&&O()},onFailure:function(e){delete e.returnValue,"function"==typeof p&&(w(e,"PDOT","Power.deleteOnTimer returns failure."),p(e))}})}},onFailure:function(e){delete e.returnValue,"function"==typeof p&&(w(e,"PDOT","Power.deleteOnTimer returns failure"),p(e))}})})},onFailure:function(e){delete e.returnValue,"function"==typeof p&&(w(e,"PDOT","Power.deleteOnTimer returns failure."),p(e))}})}})},s.prototype.addOffTimer=function(f,m,a){if(JSON.stringify(a),void 0===a.hour||isNaN(a.hour)||"number"!=typeof a.hour||a.hour<0||23<a.hour||void 0===a.minute||isNaN(a.minute)||"number"!=typeof a.minute||a.minute<0||59<a.minute||void 0===a.week||isNaN(a.week)||"number"!=typeof a.week||a.week<=0||127<a.week){if("function"==typeof m){var e={};w(e,"PAOT","Power.addOffTimer returns failure. Invalid parameter."),m(e)}}else T(function(e){4===e.webOSVer||4<e.webOSVer?y.Request("luna://com.webos.service.commercial.scapadapter/settings/",{method:"get",parameters:{category:"commercial",keys:["onOffTimeSchedule"]},onSuccess:function(e){if(!0===e.returnValue){for(var t=0,n={onTime:[],offTime:[]},i=[],o={},r=1;0!==a.week;){if(1&a.week)switch(r){case 1:i.push("mon");break;case 2:i.push("tue");break;case 4:i.push("wed");break;case 8:i.push("thu");break;case 16:i.push("fri");break;case 32:i.push("sat");break;case 64:i.push("sun")}if(a.week=a.week>>>1,r<<=1,0===a.week)break}o.day=i,o.hour=a.hour,o.minute=a.minute,n.offTime.push(o),o={};var u=null===e.settings.onOffTimeSchedule.onTime||void 0===e.settings.onOffTimeSchedule.onTime?0:e.settings.onOffTimeSchedule.onTime.length;for(t=0;t<u;t++)void 0!==e.settings.onOffTimeSchedule.onTime[t].day&&null!==e.settings.onOffTimeSchedule.onTime[t].day&&(o.day=e.settings.onOffTimeSchedule.onTime[t].day),void 0!==e.settings.onOffTimeSchedule.onTime[t].hour&&null!==e.settings.onOffTimeSchedule.onTime[t].hour&&(o.hour=e.settings.onOffTimeSchedule.onTime[t].hour),void 0!==e.settings.onOffTimeSchedule.onTime[t].minute&&null!==e.settings.onOffTimeSchedule.onTime[t].minute&&(o.minute=e.settings.onOffTimeSchedule.onTime[t].minute),n.onTime.push(o),o={};var s=null===e.settings.onOffTimeSchedule.offTime||void 0===e.settings.onOffTimeSchedule.offTime?0:e.settings.onOffTimeSchedule.offTime.length;for(t=0;t<s;t++)void 0!==e.settings.onOffTimeSchedule.offTime[t].day&&null!==e.settings.onOffTimeSchedule.offTime[t].day&&(o.day=e.settings.onOffTimeSchedule.offTime[t].day),void 0!==e.settings.onOffTimeSchedule.offTime[t].hour&&null!==e.settings.onOffTimeSchedule.offTime[t].hour&&(o.hour=e.settings.onOffTimeSchedule.offTime[t].hour),void 0!==e.settings.onOffTimeSchedule.offTime[t].minute&&null!==e.settings.onOffTimeSchedule.offTime[t].minute&&(o.minute=e.settings.onOffTimeSchedule.offTime[t].minute),n.offTime.push(o),o={};y.Request("luna://com.webos.service.commercial.scapadapter/settings/",{method:"set",parameters:{category:"commercial",settings:{onOffTimeSchedule:n}},onSuccess:function(){"function"==typeof f&&f()},onFailure:function(e){delete e.returnValue,"function"==typeof m&&(w(e,"PAOT","Power.addOffTimer returns failure."),m(e))}})}},onFailure:function(e){delete e.returnValue,"function"==typeof m&&(w(e,"PAOT","Power.addOffTimer returns failure."),m(e))}}):y.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"get",parameters:{category:"commercial",keys:["multiOffTimerHour","multiOffTimerMinute","multiOffTimerWeekday","offTimerSchedule","offTimerCount"]},onSuccess:function(n){if(!0===n.returnValue){"string"==typeof n.settings.multiOffTimerHour&&(n.settings.multiOffTimerHour=JSON.parse(n.settings.multiOffTimerHour)),"string"==typeof n.settings.multiOffTimerMinute&&(n.settings.multiOffTimerMinute=JSON.parse(n.settings.multiOffTimerMinute)),"string"==typeof n.settings.multiOffTimerWeekday&&(n.settings.multiOffTimerWeekday=JSON.parse(n.settings.multiOffTimerWeekday)),"string"==typeof n.settings.offTimerSchedule&&(n.settings.offTimerSchedule=JSON.parse(n.settings.offTimerSchedule));var i=null===n.settings.offTimerSchedule||void 0===n.settings.offTimerSchedule?0:n.settings.offTimerSchedule.length;if(n.settings.multiOffTimerHour.length<=i)return void("function"==typeof m&&(w(n,"PAOT","Power.addOffTimer returns failure. No space to add timer."),m(n)));T(function(e){e.webOSVer,3===e.webOSVer&&(64<=a.week?a.week=1+2*(a.week-64):a.week=2*a.week),n.settings.multiOffTimerHour[i]=a.hour,n.settings.multiOffTimerMinute[i]=a.minute,n.settings.multiOffTimerWeekday[i]=a.week,a.hour,a.minute,a.week;var t=360;n.settings.offTimerSchedule[i]={_id:""+t++,hour:a.hour,minute:a.minute,weekday:a.week},y.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"commercial",settings:{multiOffTimerHour:n.settings.multiOffTimerHour,multiOffTimerMinute:n.settings.multiOffTimerMinute,multiOffTimerWeekday:n.settings.multiOffTimerWeekday,offTimerCount:i+1,offTimerSchedule:n.settings.offTimerSchedule}},onSuccess:function(){"function"==typeof f&&f()},onFailure:function(e){delete e.returnValue,"function"==typeof m&&(w(e,"PAOT","Power.addOffTimer returns failure."),m(e))}})})}},onFailure:function(e){delete e.returnValue,"function"==typeof m&&(w(e,"PAOT","Power.addOffTimer returns failure."),m(e))}})})},s.prototype.deleteOffTimer=function(a,l,c){JSON.stringify(c),T(function(e){if(4===e.webOSVer||4<e.webOSVer){if(void 0===c.hour||isNaN(c.hour)||"number"!=typeof c.hour||c.hour<0||23<c.hour||void 0===c.minute||isNaN(c.minute)||"number"!=typeof c.minute||c.minute<0||59<c.minute||void 0===c.week||isNaN(c.week)||"number"!=typeof c.week||c.week<0||127<c.week){if("function"==typeof l)w(t={},"PAOT","Power.deleteOffTimer returns failure. invalid parameters or out of range."),l(t);return}y.Request("luna://com.webos.service.commercial.scapadapter/settings/",{method:"get",parameters:{category:"commercial",keys:["onOffTimeSchedule"]},onSuccess:function(e){if(!0===e.returnValue){for(var t=0,n={onTime:[],offTime:[]},i=[],o={},r={},u=1;0!==c.week;){if(1&c.week)switch(u){case 1:i.push("mon");break;case 2:i.push("tue");break;case 4:i.push("wed");break;case 8:i.push("thu");break;case 16:i.push("fri");break;case 32:i.push("sat");break;case 64:i.push("sun")}if(c.week=c.week>>>1,u<<=1,0===c.week)break}u=0,o.day=i,o.hour=c.hour,o.minute=c.minute;var s=null===e.settings.onOffTimeSchedule.onTime||void 0===e.settings.onOffTimeSchedule.onTime?0:e.settings.onOffTimeSchedule.onTime.length,f=!1;for(t=0;t<s;t++)void 0!==e.settings.onOffTimeSchedule.onTime[t].day&&null!==e.settings.onOffTimeSchedule.onTime[t].day&&(r.day=e.settings.onOffTimeSchedule.onTime[t].day),void 0!==e.settings.onOffTimeSchedule.onTime[t].hour&&null!==e.settings.onOffTimeSchedule.onTime[t].hour&&(r.hour=e.settings.onOffTimeSchedule.onTime[t].hour),void 0!==e.settings.onOffTimeSchedule.onTime[t].minute&&null!==e.settings.onOffTimeSchedule.onTime[t].minute&&(r.minute=e.settings.onOffTimeSchedule.onTime[t].minute),n.onTime.push(r),r={};var m=null===e.settings.onOffTimeSchedule.offTime||void 0===e.settings.onOffTimeSchedule.offTime?0:e.settings.onOffTimeSchedule.offTime.length;for(t=0;t<m;t++)void 0!==e.settings.onOffTimeSchedule.offTime[t].day&&null!==e.settings.onOffTimeSchedule.offTime[t].day&&(d(e.settings.onOffTimeSchedule.offTime[t].day,o.day)?u++:r.day=e.settings.onOffTimeSchedule.offTime[t].day),void 0!==e.settings.onOffTimeSchedule.offTime[t].hour&&null!==e.settings.onOffTimeSchedule.offTime[t].hour&&(e.settings.onOffTimeSchedule.offTime[t].hour===o.hour?u++:r.hour=e.settings.onOffTimeSchedule.offTime[t].hour),void 0!==e.settings.onOffTimeSchedule.offTime[t].minute&&null!==e.settings.onOffTimeSchedule.offTime[t].minute&&(e.settings.onOffTimeSchedule.offTime[t].minute===o.minute?u++:r.minute=e.settings.onOffTimeSchedule.offTime[t].minute),3!==u?n.offTime.push(r):f=!0,u=0,r={};if(f)y.Request("luna://com.webos.service.commercial.scapadapter/settings/",{method:"set",parameters:{category:"commercial",settings:{onOffTimeSchedule:n}},onSuccess:function(){"function"==typeof a&&a()},onFailure:function(e){delete e.returnValue,"function"==typeof l&&(w(e,"PAOT","Power.deleteOffTimer returns failure."),l(e))}});else w(e={},"PAOT","Power.deleteOffTimer returns failure. / No matched found."),l(e)}},onFailure:function(e){delete e.returnValue,"function"==typeof l&&(w(e,"PAOT","Power.deleteOffTimer returns failure."),l(e))}})}else{if(void 0===c.hour||isNaN(c.hour)||"number"!=typeof c.hour||c.hour<0||23<c.hour||void 0===c.minute||isNaN(c.minute)||"number"!=typeof c.minute||c.minute<0||59<c.minute||void 0===c.week||isNaN(c.week)||"number"!=typeof c.week||c.week<0||127<c.week){var t;if("function"==typeof l)w(t={},"PDOT","Power.deleteOffTimer returns failure. invalid parameters or out of range."),l(t);return}y.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"get",parameters:{category:"commercial",keys:["multiOffTimerHour","multiOffTimerMinute","multiOffTimerWeekday","offTimerSchedule","offTimerCount"]},onSuccess:function(e){if(!0===e.returnValue){"string"==typeof e.settings.multiOffTimerHour&&(e.settings.multiOffTimerHour=JSON.parse(e.settings.multiOffTimerHour)),"string"==typeof e.settings.multiOffTimerMinute&&(e.settings.multiOffTimerMinute=JSON.parse(e.settings.multiOffTimerMinute)),"string"==typeof e.settings.multiOffTimerWeekday&&(e.settings.multiOffTimerWeekday=JSON.parse(e.settings.multiOffTimerWeekday)),"string"==typeof e.settings.offTimerSchedule&&(e.settings.offTimerSchedule=JSON.parse(e.settings.offTimerSchedule));var t=0,n=null===e.settings.offTimerSchedule||void 0===e.settings.offTimerSchedule?0:e.settings.offTimerSchedule.length,i=["0","0","0","0","0","0","0"],o=["0","0","0","0","0","0","0"],r=["0","0","0","0","0","0","0"],u=[],s=!1;T(function(e){e.webOSVer,3===e.webOSVer&&(64<=c.week?c.week=1+2*(c.week-64):c.week=2*c.week)});for(var f=0;f<n;f++)null!==e.settings.offTimerSchedule[f]&&(c.week,e.settings.offTimerSchedule[f].weekday,!1===s&&c.hour===e.settings.offTimerSchedule[f].hour&&c.minute===e.settings.offTimerSchedule[f].minute&&c.week===e.settings.offTimerSchedule[f].weekday?s=!0:(i[t]=e.settings.multiOffTimerHour[f],o[t]=e.settings.multiOffTimerMinute[f],r[t]=e.settings.multiOffTimerWeekday[f],u[t]=e.settings.offTimerSchedule[f],t++));if(!0===s&&n--,0===n&&(u=[]),e.settings.offTimerSchedule.length===n)return void("function"==typeof l&&(w(e,"PDOT","Power.deleteOffTimer returns failure. There is no 'off timer' matched in the list."),l(e)));y.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"commercial",settings:{multiOffTimerHour:i,multiOffTimerMinute:o,multiOffTimerWeekday:r,offTimerCount:n,offTimerSchedule:u}},onSuccess:function(){"function"==typeof a&&a()},onFailure:function(e){delete e.returnValue,"function"==typeof l&&(w(e,"PDOT","Power.deleteOffTimer returns failure."),l(e))}})}},onFailure:function(e){delete e.returnValue,"function"==typeof l&&(w(e,"PDOT","Power.deleteOffTimer returns failure."),l(e))}})}})},s.prototype.getOnTimerList=function(a,t){T(function(e){4===e.webOSVer||4<e.webOSVer?y.Request("luna://com.webos.service.commercial.scapadapter/settings/",{method:"get",parameters:{category:"commercial",keys:["onOffTimeSchedule"]},onSuccess:function(e){if(!0===e.returnValue){for(var t={},n=new Array(null===e.settings.onOffTimeSchedule.onTime||void 0===e.settings.onOffTimeSchedule.onTime?0:e.settings.onOffTimeSchedule.onTime.length),i=0,o=0;o<n.length;o++,i++)if(null!==e.settings.onOffTimeSchedule.onTime[o]&&void 0!==e.settings.onOffTimeSchedule.onTime[o]){n[i]={hour:0,minute:0,week:0};for(var r=e.settings.onOffTimeSchedule.onTime[o].day,u=0,s=0;s<r.length;s++)"mon"===r[s]&&(u+=1),"tue"===r[s]&&(u+=2),"wed"===r[s]&&(u+=4),"thu"===r[s]&&(u+=8),"fri"===r[s]&&(u+=16),"sat"===r[s]&&(u+=32),"sun"===r[s]&&(u+=64);n[i].hour=e.settings.onOffTimeSchedule.onTime[o].hour,n[i].minute=e.settings.onOffTimeSchedule.onTime[o].minute,n[i].week=u}t.timerList=n,"function"==typeof a&&a(t)}},onFailure:function(e){delete e.returnValue,"function"==typeof t&&(w(e,"PGOTL","Power.getOnTimerList returns failure."),t(e))}}):y.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"get",parameters:{category:"commercial",keys:["onTimerSchedule"]},onSuccess:function(m){!0===m.returnValue&&T(function(e){e.webOSVer;var t={};"string"==typeof m.settings.onTimerSchedule&&(m.settings.onTimerSchedule=JSON.parse(m.settings.onTimerSchedule));for(var n=new Array(null===m.settings.onTimerSchedule||void 0===m.settings.onTimerSchedule?0:m.settings.onTimerSchedule.length),i=0,o=0;o<n.length;o++)if(null!==m.settings.onTimerSchedule[o]&&void 0!==m.settings.onTimerSchedule[o]){if(n[i]={hour:0,minute:0,week:0,inputSource:0},3===e.webOSVer){var r=m.settings.onTimerSchedule[o].weekday;if(r%2)r=64+(r-r%2)/2;else r/=2}else r=m.settings.onTimerSchedule[o].weekday;n[i].hour=m.settings.onTimerSchedule[o].hour,n[i].minute=m.settings.onTimerSchedule[o].minute,n[i].week=r;var u="ext://",s=m.settings.onTimerSchedule[o].input.toUpperCase(),f="1";!1===isNaN(s.substring(s.length-1,s.length))&&(f=s.substring(s.length-1,s.length),s=s.substring(0,s.length-1)),u="DISPLAYPORT"===(s=s.split("/")[0]).toUpperCase()?u+"dp:"+f:u+s.toLowerCase()+":"+f,n[i++].inputSource=u}t.timerList=n,"function"==typeof a&&a(t)})},onFailure:function(e){delete e.returnValue,"function"==typeof t&&(w(e,"PGOTL","Power.getOnTimerList returns failure."),t(e))}})})},s.prototype.getOffTimerList=function(f,t){T(function(e){4===e.webOSVer||4<e.webOSVer?y.Request("luna://com.webos.service.commercial.scapadapter/settings/",{method:"get",parameters:{category:"commercial",keys:["onOffTimeSchedule"]},onSuccess:function(e){if(!0===e.returnValue){for(var t={},n=new Array(null===e.settings.onOffTimeSchedule.offTime||void 0===e.settings.onOffTimeSchedule.offTime?0:e.settings.onOffTimeSchedule.offTime.length),i=0,o=0;o<n.length;o++,i++)if(null!==e.settings.onOffTimeSchedule.offTime[o]&&void 0!==e.settings.onOffTimeSchedule.offTime[o]){n[i]={hour:0,minute:0,week:0};for(var r=e.settings.onOffTimeSchedule.offTime[o].day,u=0,s=0;s<r.length;s++)"mon"===r[s]&&(u+=1),"tue"===r[s]&&(u+=2),"wed"===r[s]&&(u+=4),"thu"===r[s]&&(u+=8),"fri"===r[s]&&(u+=16),"sat"===r[s]&&(u+=32),"sun"===r[s]&&(u+=64);n[i].hour=e.settings.onOffTimeSchedule.offTime[o].hour,n[i].minute=e.settings.onOffTimeSchedule.offTime[o].minute,n[i].week=u}t.timerList=n,"function"==typeof f&&f(t)}},onFailure:function(e){delete e.returnValue,"function"==typeof t&&(w(e,"PGOTL","Power.getOffTimerList returns failure."),t(e))}}):y.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"get",parameters:{category:"commercial",keys:["offTimerSchedule"]},onSuccess:function(u){T(function(e){if(e.webOSVer,!0===u.returnValue){var t={};"string"==typeof u.settings.offTimerSchedule&&(u.settings.offTimerSchedule=JSON.parse(u.settings.offTimerSchedule));for(var n=new Array(null===u.settings.offTimerSchedule||void 0===u.settings.offTimerSchedule?0:u.settings.offTimerSchedule.length),i=0,o=0;o<n.length;o++)if(null!==u.settings.offTimerSchedule[o]&&void 0!==u.settings.offTimerSchedule[o]){if(n[i]={hour:0,minute:0,week:0},3===e.webOSVer){var r=u.settings.offTimerSchedule[o].weekday;if(r%2)r=64+(r-r%2)/2;else r/=2}else r=u.settings.offTimerSchedule[o].weekday;n[i].hour=u.settings.offTimerSchedule[o].hour,n[i].minute=u.settings.offTimerSchedule[o].minute,n[i++].week=r}t.timerList=n,"function"==typeof f&&f(t)}})},onFailure:function(e){delete e.returnValue,"function"==typeof t&&(w(e,"PGOTL","Power.getOffTimerList returns failure."),t(e))}})})},s.prototype.setDisplayMode=function(t,n,r){JSON.stringify(r);var u=null;switch(r.displayMode){case s.DisplayMode.DISPLAY_OFF:u="turnOffScreen";break;case s.DisplayMode.DISPLAY_ON:u="turnOnScreen";break;default:var e;if("function"==typeof n)w(e={},"PSDM","Power.setDisplayMode returns failure. Invalid option value."),n(e);return}if(null===u&&"function"==typeof n)return w(e={},"PSDM","Power.setDisplayMode returns failure. command was not defined."),void n(e);T(function(e){4===e.webOSVer||4<e.webOSVer?y.Request("luna://com.webos.service.commercial.scapadapter/power",{method:"setDisplayMode",parameters:{displayMode:r.displayMode},onSuccess:function(e){delete e.returnValue,!0===e.returnValue&&"function"==typeof t&&t(e)},onFailure:function(e){delete e.returnValue,"function"==typeof o&&(i(e,"PSDM","Power.setDisplayMode returns failure."),o(e))}}):y.Request("luna://com.webos.service.tv.signage/",{method:"getPowerState",onSuccess:function(e){!0!==e.returnValue||e.state!==r.displayMode?y.Request("luna://com.webos.service.tv.signage/",{method:u,onSuccess:function(e){!0===e.returnValue&&"function"==typeof t&&t()},onFailure:function(e){delete e.returnValue,"function"==typeof n&&(w(e,"PSDM","Power.setDisplayMode returns failure."),n(e))}}):"function"==typeof t&&t()},onFailure:function(e){delete e.returnValue,"function"==typeof n&&(w(e,"PSDM","Power.setDisplayMode returns failure."),n(e))}})})},s.prototype.executePowerCommand=function(t,n,i){if(JSON.stringify(i),void 0===i.powerCommand||"string"!=typeof i.powerCommand||null===i.powerCommand||i.powerCommand.length<=0){"function"==typeof n&&(w(e={},"PEPM","Power.executePowerCommand returns failure. invalid argument or out of range. "),n(e))}else{var e;if(i.powerCommand!==s.PowerCommand.REBOOT&&i.powerCommand!==s.PowerCommand.SHUTDOWN)return w(e={},"PEPM","Power.executePowerCommand returns failure. invalid argument."),void n(e);T(function(e){4===e.webOSVer||4<e.webOSVer?y.Request("luna://com.webos.service.commercial.scapadapter/power",{method:"executePowerCommand",parameters:{powerCommand:i.powerCommand},onSuccess:function(e){!0===e.returnValue&&"function"==typeof t&&t()},onFailure:function(e){delete e.returnValue,"function"==typeof n&&(w(e,"PEPM","Power.executePowerCommand returns failure."),n(e))}}):y.Request("luna://com.webos.service.tv.signage/",{method:i.powerCommand,parameters:{reason:"unknown"},onSuccess:function(e){!0===e.returnValue&&"function"==typeof t&&t()},onFailure:function(e){delete e.returnValue,"function"==typeof n&&(w(e,"PEPM","Power.executePowerCommand returns failure."),n(e))}})})}},s.prototype.setDPMWakeup=function(t,n,e){var i=null;switch(e.dpmSignalType){case s.DPMSignalType.CLOCK:i="clock";break;case s.DPMSignalType.CLOCK_WITH_DATA:i="clockAndData"}if(null===i&&"function"==typeof n){var o={};return w(o,"PSDW","Power.setDPMWakeup returns failure. command was not defined."),void n(o)}y.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"commercial",settings:{dpmWakeUpControl:i}},onSuccess:function(e){!0===e.returnValue&&"function"==typeof t&&t()},onFailure:function(e){delete e.returnValue,"function"==typeof n&&(w(e,"PSDW","Power.setDPMWakeup returns failure."),n(e))}})},s.prototype.getDPMWakeup=function(n,t){y.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"get",parameters:{category:"commercial",keys:["dpmWakeUpControl"]},onSuccess:function(e){if(!0===e.returnValue){var t={};t.dpmSignalType=e.settings.dpmWakeUpControl,"function"==typeof n&&n(t)}},onFailure:function(e){delete e.returnValue,"function"==typeof t&&(w(e,"PGDW","Power.getDPMWakeup returns failure."),t(e))}})},s.prototype.setPMMode=function(t,n,e){var i=null;switch(e.mode){case s.PMMode.PowerOff:i="powerOff";break;case s.PMMode.SustainAspectRatio:i="sustainAspectRatio";break;case s.PMMode.ScreenOff:i="screenOff";break;case s.PMMode.ScreenOffAlways:i="screenOffAlways";break;case s.PMMode.ScreenOffBacklight:i="screenOffBacklight"}if(null===i&&"function"==typeof n){var o={};return w(o,"PSPM","Power.setPMMode returns failure. command was not defined."),void n(o)}y.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"commercial",settings:{pmMode:i}},onSuccess:function(e){!0===e.returnValue&&"function"==typeof t&&t()},onFailure:function(e){delete e.returnValue,"function"==typeof n&&(w(e,"PSPM","Power.setPMMode returns failure."),n(e))}})},s.prototype.getPMMode=function(n,t){y.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"get",parameters:{category:"commercial",keys:["pmMode"]},onSuccess:function(e){if(!0===e.returnValue){var t={};t.mode=e.settings.pmMode,"function"==typeof n&&n(t)}},onFailure:function(e){delete e.returnValue,"function"==typeof t&&(w(e,"PGPM","Power.getPMMode returns failure."),t(e))}})},s.prototype.setPowerOnDelay=function(t,n,e){var i;return e.delayTime,null===e.delayTime&&"function"==typeof n?(w(i={},"PSPD","Power.setPowerOnDelay returns failure. command was not defined."),void n(i)):"number"!=typeof e.delayTime?(w(i={},"PSPD","Power.setPowerOnDelay returns failure. delayTime is not a number."),void n(i)):e.delayTime<0||250<e.delayTime?(w(i={},"PSPD","Power.setPowerOnDelay returns failure. Out of range."),void n(i)):void y.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"commercial",settings:{powerOnDelay:e.delayTime}},onSuccess:function(e){!0===e.returnValue&&"function"==typeof t&&t()},onFailure:function(e){delete e.returnValue,"function"==typeof n&&(w(e,"PSPD","Power.setPowerOnDelay returns failure."),n(e))}})},s.prototype.getPowerOnDelay=function(n,t){y.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"get",parameters:{category:"commercial",keys:["powerOnDelay"]},onSuccess:function(e){if(!0===e.returnValue){var t={};t.delayTime=e.settings.powerOnDelay,"function"==typeof n&&n(t)}},onFailure:function(e){delete e.returnValue,"function"==typeof t&&(w(e,"PGPD","Power.getPowerOnDelay returns failure."),t(e))}})},s.prototype.getOnOffTimeSchedule=function(n,t){y.Request("luna://com.webos.service.commercial.signage.storageservice/",{method:"getOnOffTimeSchedule",parameters:{},onSuccess:function(e){if(!0===e.returnValue&&"function"==typeof n){var t={};t.onOffTimeScheduleList=e.settings.onOffTimeSchedule,"function"==typeof n&&n(t)}},onFailure:function(e){delete e.returnValue,"function"==typeof t&&(w(e,"TGAS","Power.getOnOffTimeSchedule returns failure."),t(e))}})},s.prototype.setOnOffTimeSchedule=function(t,n,e){y.Request("luna://com.webos.service.commercial.signage.storageservice/",{method:"setOnOffTimeSchedule",parameters:e,onSuccess:function(e){!0===e.returnValue&&"function"==typeof t&&"function"==typeof t&&t()},onFailure:function(e){delete e.returnValue,"function"==typeof n&&(w(e,"TGAS","Power.setOnOffTimeSchedule returns failure."),n(e))}})},s.prototype.unsetOnOffTimeSchedule=function(t,n){y.Request("luna://com.webos.service.commercial.signage.storageservice/",{method:"unsetOnOffTimeSchedule",parameters:{},onSuccess:function(e){!0===e.returnValue&&"function"==typeof t&&"function"==typeof t&&t()},onFailure:function(e){delete e.returnValue,"function"==typeof n&&(w(e,"TGAS","Power.unsetOnOffTimeSchedule returns failure."),n(e))}})},s}();